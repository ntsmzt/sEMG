#include "ann.h"
#include <QDebug>

QString gesturenames[5]={"LEFT","RIGHT","FIST","SPREAD","YEAH"};
double theta1[hidden_layer_size*(input_layer_size+1)]={0.730653487984224,-0.0116725921511938,-0.0143809620752381,6.31551526015572e-05,-0.0138158028613663,-8.99867479749527,-6.80248068452096e-05,7.50122755647531e-05,6.93034870152352e-05,7.94038277558034e-05,-7.68465542244123e-05,-0.00513209532211765,-0.00754482066122042,7.39763441073385e-05,-0.00761996278800243,-2.87267500844615,7.62960032022764e-05,7.71390441724295e-05,-7.63760738900303e-05,-7.54594862201629e-05,7.58386732794662e-05,0.00189987694776063,0.00262206901258062,7.91294786013929e-05,0.00262603455482304,0.280264145659445,7.22321092923418e-05,7.69096099573827e-05,-7.45540085967323e-05,7.46011307273131e-05,-7.49118747797855e-05,0.0170363190684253,0.0235935133283607,8.98673284916112e-05,0.0236775346400093,6.15498098315582,6.51836466411371e-05,7.65137031997751e-05,-7.31937551887158e-05,-7.74822607772866e-05,7.51200515665832e-05,0.00871478539656946,0.0102716725773260,8.50743840170662e-05,0.0102291031025159,2.31802748149014,6.96272960378692e-05,7.42437040753365e-05,-7.22156163494770e-05,7.48004782491961e-05,7.43144231945694e-05,
        -0.157965616918861,0.00170383166643281,0.00192584630976224,7.73918306715641e-05,0.00193283896768245,2.00358994865630,7.35272668081080e-05,-7.55210804089403e-05,7.52149660250151e-05,-7.58915010150797e-05,-7.50240850728109e-05,-0.000368020183955544,-0.000505016784704501,-7.56788088289112e-05,-0.000521758123104593,0.254680590366196,7.49626410286826e-05,7.54362595317069e-05,-7.57567326787290e-05,-7.48194317536919e-05,-7.49919627027781e-05,-0.000818010667506786,-0.00145481220814518,-7.65920830812837e-05,-0.00144904122278439,-0.178126925916596,7.57959195375691e-05,-7.42482009990750e-05,7.45149190014094e-05,7.51985057399532e-05,7.57015721516624e-05,-0.000954032143501227,-0.00142601399919188,-7.69104284413864e-05,-0.00143261951330701,-0.312941701096500,7.53904822307005e-05,7.54398018772883e-05,-7.54487557358968e-05,-7.49402711720221e-05,-7.51673740352383e-05,-0.00381040595170055,-0.00500837736964752,-7.92015217261213e-05,-0.00504698420884654,-1.22178641550564,7.76884122448197e-05,-7.49029667410064e-05,-7.62338568017111e-05,7.55948944516013e-05,7.50523814919247e-05,
        -0.193061135830022,-0.000426786769936972,-0.000976415797326898,7.30555753113221e-05,-0.000987139684650241,0.444892137652677,-7.38742891745573e-05,-7.43447866118758e-05,7.44154068427785e-05,7.56877526914114e-05,7.46606855171261e-05,0.00348581955622859,0.00423234900246050,-7.22067875939916e-05,0.00423597000821865,1.99547277166735,-7.69476040805737e-05,-7.43149416275762e-05,7.50483430794150e-05,-7.51967677872050e-05,7.52029348068881e-05,-0.00309088962865478,-0.00461299055250596,7.36418281533487e-05,-0.00466013360850404,-1.16656459171605,7.59434431462454e-05,7.58508560992204e-05,-7.56465280585406e-05,7.52244239348710e-05,7.52796566271683e-05,-0.00234565918488715,-0.00329190539486637,7.36017795519957e-05,-0.00330041038219789,-0.868203281894262,-7.39484366201733e-05,-7.50511825707853e-05,-7.47727996178523e-05,-7.49084640793728e-05,-7.48038442615502e-05,-0.00187465186363352,-0.00248825111480457,-7.54764108417361e-05,-0.00249429296030384,-0.691514974412829,-7.46505033102376e-05,-7.49600864976669e-05,-7.51492742787353e-05,-7.45107329737583e-05,7.47838607531734e-05,
        -0.174328055352843,-0.000734992323064671,-0.00125081545149098,7.20269277847786e-05,-0.00125821405047129,0.254798209244935,7.62238385090098e-05,-7.49662319321906e-05,-7.59768780224058e-05,-7.44821056919326e-05,7.45064577125472e-05,0.00379375052363134,0.00470539356948353,7.79521071706122e-05,0.00466957422965116,2.12632652048539,-7.69716208379584e-05,-7.43481792598173e-05,7.55900920477399e-05,-7.50329192818186e-05,7.50268837955084e-05,-0.00323679069136711,-0.00484343399083203,-7.66747779032051e-05,-0.00485885823841714,-1.23777315131177,7.60119039356923e-05,-7.39857224701589e-05,7.42324804756961e-05,7.51790235728619e-05,7.53747929566346e-05,-0.00231622645228154,-0.00332360734231607,7.37647232560855e-05,-0.00330838419732198,-0.886805279436349,-7.41960490983311e-05,7.48222258291425e-05,-7.51129843633658e-05,7.52238835302390e-05,7.52969687030937e-05,-0.00164279013215734,-0.00217133252090861,7.47954707150831e-05,-0.00217075100233547,-0.612753984831266,-7.46355254811613e-05,-7.50768400814644e-05,-7.51610892196468e-05,-7.46175086766130e-05,-7.56095070331261e-05,
        0.00111735116831313,0.00147064303178694,0.00194776831143183,-7.23730815024186e-05,0.00194056151789050,0.683490759376485,7.23651895345372e-05,-7.60643421254968e-05,-7.46857732108820e-05,7.41110453257536e-05,7.53035706488443e-05,-0.00454692947338082,-0.00619062678205336,7.09690571038601e-05,-0.00614639533009503,-2.26232588187224,-7.17954446350686e-05,7.46291171560014e-05,-7.57480337361848e-05,-7.46503059507314e-05,7.54252455625201e-05,0.00315386557975066,0.00433448768227132,7.64862276054997e-05,0.00468585901653288,1.23218845996866,-7.52448616054483e-05,7.52057307418477e-05,7.56648343239561e-05,7.52931149466820e-05,-7.49346230120270e-05,0.00231402389449209,0.00344099079161438,-7.46025358207538e-05,0.00333809227921248,0.926368230796567,-7.59692913058687e-05,7.57426005632853e-05,-7.51417823823630e-05,-7.50192296496424e-05,7.52322425398803e-05,-0.000442091849568576,6.25798061638871e-05,-7.64867129952613e-05,-0.000537575482500499,-0.0265965951348883,7.62581244996893e-05,7.55011145160622e-05,7.46888863028400e-05,-7.50061626619170e-05,7.56689572146921e-05,
        -0.0153651188387846,0.00143220165076127,0.00210758365333683,7.75917276597835e-05,0.00207152985995474,0.783770839990688,-7.73119133272759e-05,7.41404999759267e-05,7.54868159284048e-05,7.38938961371326e-05,7.54224760938684e-05,-0.00464672381573409,-0.00594295981835914,-7.91017145201983e-05,-0.00597749764145858,-2.30292246466203,-7.22540638668345e-05,7.42673329172660e-05,-7.57862343046144e-05,7.50077124766292e-05,-7.51637717890532e-05,0.00315611796834422,0.00434966565994491,-7.42475215169599e-05,0.00435454675526094,1.24767976215674,-7.55619648821094e-05,-7.50046941111447e-05,-7.45973498348208e-05,-7.51494034959772e-05,-7.52092822315129e-05,0.00244876160407567,0.00348039190973481,7.54615862731688e-05,0.00349058900267851,0.941872465390277,7.39782747787078e-05,-7.39457545866442e-05,7.50256441263240e-05,-7.49711786089376e-05,7.53135009434226e-05,-0.000626277071159665,-0.000655358394256141,-7.71584822538578e-05,-0.000673930131424410,-0.0888268837174342,7.65161624007545e-05,-7.51576198488229e-05,7.37813095841269e-05,7.47324728364457e-05,-7.50919749998929e-05,
        -0.218169978626034,0.000765281935318525,0.000765282012479746,-7.48168177686665e-05,0.000754974501525464,1.29922955592549,7.38719642145210e-05,7.51645940509832e-05,-7.50810909720095e-05,-7.51628783183759e-05,-7.52642570065189e-05,0.00198099696208165,0.00218797829193926,7.61698528886086e-05,0.00219882741271556,1.23171396582179,-7.65795537047908e-05,-7.47316557297612e-05,7.49802451892107e-05,7.50232732961388e-05,7.50619342195201e-05,-0.00193444388948841,-0.00299469560476350,7.37392987537882e-05,-0.00299457424636939,-0.668758201724842,7.60311407533472e-05,7.57482632921664e-05,7.43009975038612e-05,7.51882219244707e-05,7.53068043355139e-05,-0.00205694736091571,-0.00266840536674435,7.27149614689847e-05,-0.00267489114080626,-0.684792466512356,7.57977092477954e-05,-7.50783112158397e-05,7.46871077794954e-05,-7.50017440456733e-05,-7.53235320333769e-05,-0.00271501202713823,-0.00360131390721150,7.24585031681147e-05,-0.00360811061195934,-0.919553082048907,-7.32341899034377e-05,7.50200583107094e-05,7.43997993677373e-05,7.55236203116161e-05,-7.51076118285539e-05,
        -0.284165711584917,0.00305174536565808,0.00341994212987970,7.80782083047259e-05,0.00329776429537408,3.13898174718071,7.12313752316148e-05,-7.54468225862643e-05,7.55768590623613e-05,7.36906633999510e-05,-7.47163529003311e-05,-8.69810922883275e-05,-0.000214264503009165,-7.49101837182439e-05,-0.000224802436960680,0.512622126001138,-7.50144169712503e-05,-7.55079296476689e-05,7.43124324713211e-05,7.50460328223389e-05,7.49273848979915e-05,-0.00123108810323202,-0.00202839371906215,7.24348717786790e-05,-0.00203135956837152,-0.209278465051081,-7.34957712634993e-05,7.59103159599743e-05,7.40091321076326e-05,-7.46684083620339e-05,7.51777764261200e-05,-0.00225889317471260,-0.00286910522197095,7.29677471292814e-05,-0.00292106586177160,-0.633505886459920,7.59976611326922e-05,-7.52374263370425e-05,-7.59837592831716e-05,-7.46146778272249e-05,-7.50214369350664e-05,-0.00554209518467208,-0.00704690259905361,-8.05005678329211e-05,-0.00706338035462326,-1.70668963778419,7.83615768761179e-05,7.53859966303617e-05,7.33483538245718e-05,7.56227810598278e-05,-7.45302375436028e-05,
        -0.163761196315365,0.00251444855212708,0.00309451284012283,7.96872891139565e-05,0.00311201174127385,1.89929574858245,-7.78964954333020e-05,-7.49802028234229e-05,7.63803734677808e-05,-7.67390993938045e-05,7.59593045891048e-05,-0.00617571643143725,-0.00806763793242375,-7.99686029512685e-05,-0.00813592331329590,-2.83005484082892,-7.11711829229651e-05,7.40025474138378e-05,7.48101420484127e-05,7.54003617583183e-05,7.49693673086222e-05,0.00333705610950138,0.00471607342166005,-7.53295296426557e-05,0.00472111996614891,1.45506385336517,7.52749822565051e-05,7.53915187951096e-05,7.54065605902945e-05,-7.47532163678519e-05,7.48740207926433e-05,0.00287427206823713,0.00394483097134715,-7.48410540928996e-05,0.00408676963427466,1.13873133199225,7.43505263907321e-05,-7.39066228011626e-05,-7.55237378049812e-05,-7.50567065536104e-05,7.52325607271366e-05,-0.00282357536918227,-0.00356677122231648,-8.02693665986521e-05,-0.00357613659101673,-0.768334192390709,-7.15347955131513e-05,7.58688633950641e-05,-7.63393043503290e-05,7.50681556829857e-05,-7.40482043384947e-05,
        -0.0919764744857636,0.00187135872881231,0.00256408221764823,7.84807390848083e-05,0.00259748228221475,1.28596322595450,7.22686541022392e-05,-7.50746840401226e-05,7.67387975300723e-05,-7.67958409705715e-05,7.61021347590513e-05,-0.00524702858228342,-0.00681242079659922,7.16181384874941e-05,-0.00682382282116259,-2.49723854251342,7.85102622189304e-05,7.39055827195526e-05,7.45852688021840e-05,-7.49776181141772e-05,7.48263654060956e-05,0.00313053636255375,0.00439555508509756,7.56428552785447e-05,0.00439682461079797,1.31749069018510,-7.50531810677467e-05,-7.49144650802543e-05,7.51709927132208e-05,-7.49247587775090e-05,7.46441440119359e-05,0.00250499571278313,0.00357066562992963,7.50476593062004e-05,0.00357828585647497,1.01821818605659,-7.64548938831300e-05,-7.41439705886742e-05,-7.53341742138429e-05,7.49795344997591e-05,7.51325864576100e-05,-0.00174945169556952,-0.00197095474339880,7.16180138543107e-05,-0.00197582857206927,-0.401596143683009,-7.32130832854393e-05,7.54025920011104e-05,7.39737327677596e-05,-7.50816469802823e-05,-7.47818741423941e-05,
        0.210375774331818,-0.00287993480838385,-0.00356606388038108,-8.14966809786523e-05,-0.00385818822303534,-2.26175373339777,-7.18720818691671e-05,-7.46185484548912e-05,7.30684138861797e-05,7.64688066637384e-05,-7.61682722862473e-05,0.00703772477607306,0.00899660130328031,-6.96149149214868e-05,0.00900300243066193,3.10479550227021,7.13595473315778e-05,7.62795200661647e-05,7.53511411196614e-05,7.45316147090643e-05,-7.47091804519594e-05,-0.00382809422719989,-0.00506865877821711,7.56231946076461e-05,-0.00508037868974672,-1.61681141787518,-7.51169471259334e-05,7.49664420436795e-05,-7.46531343745049e-05,7.47150144059750e-05,-7.46741485786767e-05,-0.00315087871569979,-0.00456780583331478,7.39520069958101e-05,-0.00457194860041261,-1.30926956606721,-7.42912513767205e-05,7.43351629088566e-05,7.55818244493977e-05,-7.52583507821390e-05,-7.49607846890297e-05,0.00344780128208179,0.00428997942401493,-6.95285657543872e-05,0.00430185840423069,0.935686717475592,-7.86513354041300e-05,7.44290006207263e-05,7.67442584870155e-05,7.53584353632849e-05,-7.60944471727800e-05,
        -0.0972284959382884,0.00194221917482228,0.00255869565065134,-7.12485546709595e-05,0.00253454327395625,1.30211832820812,-7.80318208814762e-05,-7.50178246302415e-05,-7.45229301893718e-05,-7.63427403845758e-05,-7.40778612153137e-05,-0.00513440534869399,-0.00660540443382812,7.11453033378921e-05,-0.00662702791946140,-2.41468745955815,7.77708733599404e-05,-7.61829279210221e-05,7.46170055651804e-05,7.51848893244199e-05,-7.51323440872567e-05,0.00297798026207233,0.00416300697863484,7.54542243065495e-05,0.00416505571368569,1.26274399033790,-7.52671220980683e-05,-7.50068590127800e-05,-7.50970730924010e-05,-7.47659775285757e-05,7.48053921102813e-05,0.00240119594069490,0.00343289430194375,7.52545703889354e-05,0.00344090999630972,0.983668444285989,-7.63048346077928e-05,7.58014190014215e-05,-7.54028127462628e-05,7.52941617191289e-05,7.52561639517713e-05,-0.00170193528682808,-0.00210987958828804,7.17925518474031e-05,-0.00211899696824077,-0.438217459692153,-7.34072690687772e-05,7.56728595880751e-05,7.42052358069720e-05,-7.50309319659277e-05,7.59502064024232e-05,
        10.2588770012898,-7.59083633215614e-05,-7.59401649766860e-05,-7.50263782350642e-05,-7.61936016823552e-05,2.91043241828812e-06,-7.50332653596052e-05,-7.50319196193613e-05,-7.50333391183652e-05,7.50391785680563e-05,-7.52064071475222e-05,-7.58847431997427e-05,7.40742179547346e-05,-7.52876552827511e-05,-7.60007260246996e-05,-2.58482105038711e-05,-7.50355645182400e-05,-7.50326200663060e-05,-7.52890889153830e-05,-7.50372026350497e-05,-7.50298211666900e-05,7.46567335843650e-05,-7.55969858638579e-05,7.50345456988703e-05,7.49140241791811e-05,4.74261469849754e-05,7.50360931881239e-05,7.50321047756320e-05,-7.50360185517197e-05,-7.50361744056791e-05,-7.53537163897975e-05,-7.49635953324104e-05,-7.50372912668277e-05,7.50319049662256e-05,7.50358999079772e-05,7.27842685908106e-05,-7.50679846890130e-05,7.50326717827787e-05,7.50458646307171e-05,-7.50357341734158e-05,7.50691035948878e-05,7.47393583137668e-05,-7.54035223429978e-05,-7.50348710459967e-05,-7.54852583952242e-05,5.03705299659165e-05,7.50388373221235e-05,7.50319974578784e-05,-7.50310925638881e-05,7.50290484100187e-05,-7.50324391069490e-05,
        9.94610428284370,-7.58000139895927e-05,-7.59274586718363e-05,7.50339728127079e-05,-7.58401758132694e-05,2.25327272753853e-05,7.50309253059339e-05,7.50295907542927e-05,-7.50329227532116e-05,-7.53041194506958e-05,-7.50349900912147e-05,7.49809407533756e-05,-7.59667138250732e-05,7.50290419815625e-05,-7.60489972106938e-05,4.33935427219642e-05,7.50426830657352e-05,7.50441267463641e-05,-7.50788459840083e-05,7.50301398699685e-05,-7.53966145417408e-05,-7.51536255251899e-05,7.47516150214477e-05,7.50418646311726e-05,-7.53127563302496e-05,-6.39855737346641e-05,-7.50357216128629e-05,7.51755951625840e-05,-7.53570156882521e-05,-7.50416475176931e-05,7.50434567137586e-05,-7.49962920862020e-05,7.49932970654627e-05,-7.49987889168414e-05,7.50152216219629e-05,4.98877425555222e-05,7.50337227739243e-05,-7.50298170685153e-05,7.50317297208222e-05,7.50671076889271e-05,7.50377376478143e-05,-7.51695669066404e-05,-7.52815287675045e-05,-7.50347395551900e-05,7.48224326115146e-05,6.76707440370235e-05,7.50589234918872e-05,-7.50431445856050e-05,-7.50736074535160e-05,7.50400822161095e-05,7.50398380686000e-05,
        0.220268863127436,0.000454077382738263,0.000913213237855567,7.61838111490618e-05,0.000922981058029635,-0.479481539368715,-7.64130990535714e-05,7.43939428092560e-05,-7.43534367640983e-05,-7.56730511503358e-05,7.55203288912260e-05,-0.00365582086863290,-0.00439625567498516,-7.81006004597130e-05,-0.00439914028821791,-2.09130648076951,7.78102513219736e-05,-7.59283113326304e-05,7.48688408224602e-05,-7.49951166026608e-05,-7.49790118434834e-05,0.00319098923382352,0.00473265890871924,-7.33963701083274e-05,0.00474094143334912,1.19085502466243,7.44513765783581e-05,-7.56726538488095e-05,-7.42686898524860e-05,-7.51853486371540e-05,7.46839872113124e-05,0.00221389845491823,0.00309201046085964,-7.46238664419113e-05,0.00309398979031577,0.822917491760902,-7.60775668989197e-05,7.55619561961304e-05,7.50868964330983e-05,7.52170204450830e-05,-7.51268796777419e-05,0.00187381534973694,0.00256537987203229,-7.39764829949159e-05,0.00257212414030218,0.715140477994239,-7.57162166744010e-05,-7.47766061958188e-05,7.53650101944743e-05,-7.54754333584350e-05,7.54877395936479e-05,
        -0.152358628107252,-0.000157792345692170,-0.000446734636273630,7.31121465786691e-05,-0.000456652735941984,0.424194503740959,-7.46822572663592e-05,-7.54736957382551e-05,7.42504762955302e-05,7.51337522332363e-05,7.49002266814028e-05,0.00266749382181633,0.00334040520652075,-7.41090539021805e-05,0.00334618383274605,1.53017481357542,-7.68857509056726e-05,-7.46342464424119e-05,7.49438088521926e-05,-7.52002872433257e-05,7.46942547869724e-05,-0.00230437172469297,-0.00355201460051350,7.36419574709162e-05,-0.00355769599159275,-0.871756911265996,7.59679822596946e-05,7.55019767856276e-05,7.43809229598581e-05,7.49673908930441e-05,-7.47827618339069e-05,-0.00187724135881990,-0.00286403106206667,-7.65228470029624e-05,-0.00287287973950774,-0.728641729510904,7.59569119642767e-05,7.47888906946224e-05,7.49319416591385e-05,7.50953563844509e-05,-7.51631934562151e-05,-0.00142398414913849,-0.00202407774710293,7.41166309328015e-05,-0.00202498241273108,-0.529529012676106,-7.43554418909914e-05,7.48895002570244e-05,-7.51157344551686e-05,7.53641145392912e-05,-7.53760105441973e-05,
        -0.202969957418667,0.00289131040483396,0.00386201047210117,7.97005553211620e-05,0.00364798225979354,2.26959236037745,7.10871085559221e-05,7.44355307014057e-05,-7.36255357580120e-05,-7.69074279033910e-05,7.56990958135177e-05,-0.00705434560600988,-0.00906701241319972,-8.00119460117422e-05,-0.00910603227071780,-3.13354894514987,-7.19769911575130e-05,7.37652371909483e-05,-7.59568992511909e-05,-7.44992398687379e-05,7.47865340287092e-05,0.00380274722610090,0.00502028173455666,7.43083938331505e-05,0.00502789218354057,1.60495376294898,-7.49496614174124e-05,7.52799106038314e-05,7.49591079837123e-05,7.56025704238025e-05,7.47442122737878e-05,0.00310749950314317,0.00436304697193812,-7.41981558314237e-05,0.00437033459164028,1.26113917485949,7.40775459508592e-05,-7.46832561888688e-05,7.44978448487871e-05,7.53732165449941e-05,7.51167208417287e-05,-0.00347146691017495,-0.00437053768622189,-8.16947836376852e-05,-0.00438639290180081,-0.952773666722315,-7.17870760994604e-05,7.58109230492726e-05,7.36808264674233e-05,7.53208566543537e-05,7.61223376115124e-05,
        -0.188080836084184,-0.000578483920347339,-0.00120744986642591,7.30093179277180e-05,-0.00121021998229500,0.369466407277190,-7.40642658541632e-05,-7.47260720513176e-05,-7.57010694097929e-05,7.55419842440702e-05,7.46523384229995e-05,0.00365435175475991,0.00439878139380648,7.77391818067252e-05,0.00443182423258976,2.08306073512267,7.28147032808589e-05,-7.43810783961322e-05,-7.49014678976236e-05,-7.52431173081871e-05,-7.53500291470570e-05,-0.00325254136833773,-0.00481685636585047,7.38883187365398e-05,-0.00486098420367961,-1.22441133369529,-7.42597142354040e-05,7.58176780770614e-05,-7.53521354809937e-05,-7.49637105711471e-05,7.52861979407344e-05,-0.00237585898031594,-0.00333639992356040,-7.60277522954587e-05,-0.00334526259895126,-0.888390261488331,-7.37685969002625e-05,7.49994806598149e-05,-7.50638945225889e-05,-7.45335249713072e-05,7.51054872481944e-05,-0.00170448905824238,-0.00242493842944182,-7.52659888448915e-05,-0.00245489372633482,-0.680642522760475,-7.41994938626313e-05,-7.50950257130210e-05,-7.47847302489063e-05,-7.45780034167516e-05,7.46203407680903e-05,
        -0.215880936175461,0.00288800927978049,0.00464096650636190,8.02252251705394e-05,0.00383198054293621,2.39416945341906,7.07184575092589e-05,7.49025292648732e-05,7.68389134743694e-05,-7.73942312938523e-05,-7.34478336813912e-05,-0.00731210592849829,-0.00943225591789399,-8.06012188177251e-05,-0.00946009632315197,-3.24216736814776,-7.11819645250734e-05,-7.61924971788315e-05,7.47823859928711e-05,-7.46662151184118e-05,-7.52258593184172e-05,0.00383744350129707,0.00528643541910966,-7.57329249432601e-05,0.00522104607662933,1.66060717374576,-7.52018772406274e-05,7.53628868844619e-05,7.50841204198675e-05,-7.45015957572596e-05,-7.52354979209460e-05,0.00325860396844772,0.00448879337366057,-7.43529980377854e-05,0.00449844562822481,1.30432431637867,7.37565166231831e-05,-7.37775893417241e-05,-7.56303135250322e-05,-7.52478698793025e-05,7.49369365840241e-05,-0.00367555501021748,-0.00471749163795036,6.91448810644627e-05,-0.00473894539626170,-1.01560313084317,-7.18282274031365e-05,-7.41782025247213e-05,-7.66007215546710e-05,7.52020139674206e-05,7.58276231428782e-05,
        0.201394503125520,-0.00288545589026192,-0.00378764306071279,-8.05478077692516e-05,-0.00384987246251781,-2.17517061675026,7.80597725869699e-05,7.53512650011236e-05,-7.74640395082296e-05,7.65149514262171e-05,7.35349936984936e-05,0.00671878370486707,0.00881692985509965,-7.01137252577526e-05,0.00888708801872878,3.03600349488862,7.15780811312477e-05,7.59598655214420e-05,-7.46504173882395e-05,7.42972034275028e-05,7.50340491062466e-05,-0.00363557012131120,-0.00512555059280222,-7.45701623979056e-05,-0.00513166986473204,-1.58539955835339,7.53054301654670e-05,7.52401332114588e-05,-7.46192779165946e-05,-7.54840757369751e-05,7.54011431295369e-05,-0.00324289485802535,-0.00446068045418990,7.35762265378202e-05,-0.00447190753652289,-1.28173628450124,-7.43557482712322e-05,-7.62472532775450e-05,-7.42935217797017e-05,-7.52763315905969e-05,7.54572776363514e-05,0.00328408619406878,0.00413706775405635,-6.94736327477266e-05,0.00415431041345697,0.890408679288251,-7.84237781751997e-05,7.43242360374233e-05,7.68435323481288e-05,7.50547512139941e-05,7.39231309654940e-05,
        -1.95656552616212,0.0159657454018358,0.0213837867550460,9.83388770407267e-05,0.0212162510387701,3.47424538088772,-9.15922421346370e-05,-7.05376806211118e-05,-7.31472319867059e-05,-8.01044477800791e-05,-7.20418223775662e-05,0.0184857427859583,0.0269660457599031,-6.14972361348707e-05,0.0269823991828000,6.46751992302837,6.83076860743566e-05,7.22747875264429e-05,7.91357540903921e-05,-7.66847088884360e-05,-7.66506628232243e-05,0.0109466989635210,0.0169540823703883,8.34600818071700e-05,0.0169939159437662,3.52574383469075,-7.88957381764523e-05,-7.88904482871038e-05,-7.10797116615231e-05,7.48558035511733e-05,7.34589640558432e-05,0.00236348560214605,0.00410310031800084,7.61494801376982e-05,0.00415721965537944,0.213476993810970,7.28306927834457e-05,-7.63348936619243e-05,-7.42170204384620e-05,-7.57097487859358e-05,-7.48157211969339e-05,0.0162487428397175,0.0226558130073009,8.74138638641389e-05,0.0227066313176122,5.76034030487721,-8.32624229014919e-05,-7.49059357035818e-05,-7.14733455202200e-05,-7.75560838050993e-05,7.67988051693520e-05,
        -0.196037234269173,0.00192207541401547,0.00206214909981376,7.70429487537354e-05,0.00194254788765931,2.13200745561259,7.31102649363005e-05,-7.47873448898463e-05,-7.44887944463720e-05,7.41216222834728e-05,-7.43709748729773e-05,0.000202705773423350,0.000117403386832132,-7.46123643753896e-05,0.000118860221039885,0.510285519882000,7.45201128529849e-05,7.47917376029547e-05,-7.46174793343705e-05,-7.51948450331392e-05,-7.53051721373016e-05,-0.00104977670718935,-0.00192577282148094,7.29244770463924e-05,-0.00193638385603886,-0.278385453045882,-7.46722663998811e-05,7.54458296592394e-05,-7.56373756085564e-05,7.53360921134076e-05,7.49757004395318e-05,-0.00140060180467730,-0.00198901958367925,-7.72590658548199e-05,-0.00199851066847220,-0.470520954940729,7.55185468730383e-05,-7.47822080327164e-05,-7.56435581680068e-05,7.52561571077449e-05,-7.51203085669261e-05,-0.00389009691181791,-0.00530387969864122,-7.92412964418774e-05,-0.00531910794289429,-1.26664657936125,-7.24184555226168e-05,-7.49009188554565e-05,7.38668131082408e-05,-7.45880667258749e-05,7.53067099423205e-05,
        0.204881504061237,-0.00276854612846471,-0.00315593046002918,6.91390055907251e-05,-0.00345922994082007,-2.20907191120765,7.79795401571564e-05,-7.56040186336661e-05,7.36319216418657e-05,-7.33927190330555e-05,7.33479055231498e-05,0.00693035259388198,0.00875680000157902,8.07198146741394e-05,0.00876007556848125,3.06208447283228,7.08806874991416e-05,-7.40521793583949e-05,-7.45637714334972e-05,7.43857012293285e-05,-7.52261763733715e-05,-0.00367534632904214,-0.00515815431484626,-7.47226924112296e-05,-0.00516457033077460,-1.59692507486924,-7.54724072526290e-05,-7.52825792048350e-05,-7.45660710155600e-05,7.46919871735554e-05,7.55697280632928e-05,-0.00336578317739630,-0.00449870697414840,7.35311066995594e-05,-0.00450777771887829,-1.29192258305088,7.58524746546792e-05,-7.60529695096465e-05,7.54540671130892e-05,7.53389355430998e-05,-7.50304966217331e-05,0.00330266919858113,0.00417018691738540,-6.98090882977663e-05,0.00418356602116879,0.908691754442498,7.15515817643518e-05,7.48336818810833e-05,7.69355279173998e-05,7.47608477969937e-05,7.40494351272602e-05,
        0.154794821438885,-0.00234279465573455,-0.00292288451240333,-8.04105907873493e-05,-0.00302188509160858,-1.74293141341376,7.80449069627311e-05,-7.54331002342239e-05,-7.66259221516825e-05,7.66486021198580e-05,-7.63733304357692e-05,0.00607238598535503,0.00774073272816917,7.93039752154348e-05,0.00776131654089962,2.73356407422236,7.13967649535478e-05,-7.45618179556730e-05,-7.47756178053125e-05,7.44582513063697e-05,7.49991785633518e-05,-0.00349456326085538,-0.00466653613795765,-7.53154424765306e-05,-0.00466711948085881,-1.44260898243762,7.48896744789642e-05,7.49916996822725e-05,7.51918254381989e-05,-7.53937793664069e-05,7.55263333517279e-05,-0.00296590296307485,-0.00422206349131953,-7.63051340027848e-05,-0.00422381803847903,-1.16564904962159,-7.48182630788990e-05,7.44404495129370e-05,-7.44789113710945e-05,7.51342140480859e-05,7.50735921367343e-05,0.00247780002988899,0.00305261448375416,7.96860656735569e-05,0.00320058319834983,0.653991121584908,7.25105218707335e-05,-7.54732138839309e-05,-7.35357951336030e-05,-7.51025556297990e-05,7.42109509495656e-05,
        -0.173383165048134,-0.000322825808785001,-0.000645745682234167,7.40642394925485e-05,-0.000647954913870311,0.433149719344838,7.52047972310784e-05,7.55794422564235e-05,7.44318379923757e-05,-7.49752929848918e-05,7.44154934563484e-05,0.00309344117115098,0.00386292655058955,7.79742609019979e-05,0.00387054706447833,1.75365827223437,-7.80031607253225e-05,7.52837828405782e-05,-7.45867453149317e-05,-7.52289006306150e-05,-7.51599306529241e-05,-0.00273179143773545,-0.00403504744787647,7.42601288608369e-05,-0.00404518626974666,-1.00302393348102,-7.50386541261757e-05,7.54793207267879e-05,-7.56199201560205e-05,7.55052789638687e-05,7.52558342243997e-05,-0.00213447258794541,-0.00309253444324230,-7.57791154105968e-05,-0.00310086943287333,-0.795642111578089,7.57541207325628e-05,-7.51642561244733e-05,-7.51112104844634e-05,-7.47633050067511e-05,7.51991395871905e-05,-0.00156739063893930,-0.00220598922981944,7.47020052079693e-05,-0.00221335448054114,-0.595528234276833,7.53370705622752e-05,7.53403829064402e-05,7.50861824764073e-05,7.55558840503585e-05,7.45909264173596e-05,
        0.248602970989133,-0.000476136317480790,-0.000439680895919852,7.50091320767950e-05,-0.000422210246516482,-1.08276218443528,-7.48785288285877e-05,-7.55509678053210e-05,7.53425417729180e-05,7.45256758565585e-05,7.51335131221178e-05,-0.00250337348705359,-0.00299806025836368,7.27717430143431e-05,-0.00287144824493663,-1.49913804958830,-7.39065009378653e-05,7.47294081413364e-05,-7.57564093227662e-05,7.48178604076572e-05,7.49071048199580e-05,0.00205673863603153,0.00350718660877205,-7.33241566870155e-05,0.00343234926426168,0.798981383583613,-7.60620856614997e-05,-7.57779041478806e-05,-7.46271627699876e-05,-7.52725171144458e-05,7.46500053082522e-05,0.00189747717038641,0.00258324834313602,7.62960428830059e-05,0.00259011804470601,0.677425778370228,7.38695781855805e-05,-7.50467646659675e-05,7.52517599307877e-05,7.48738587938224e-05,-7.49567021491839e-05,0.00239183473209513,0.00328423674649000,7.72026011157082e-05,0.00329293652608081,0.849255228559077,7.34573794341002e-05,-7.49935777150125e-05,7.54957140529866e-05,-7.55521469412899e-05,7.51901966075357e-05,
        0.184716679131712,-0.00262792484383826,-0.00340760011613839,-8.01713399450172e-05,-0.00339107238747758,-2.01015185213238,7.89277422681601e-05,7.50766738859556e-05,-7.62392644739067e-05,7.67378785221430e-05,-7.64178385527010e-05,0.00643628137290733,0.00825344713319730,7.97551317273598e-05,0.00827409753690337,2.91312416920967,-7.93215750821400e-05,-7.40756279251744e-05,-7.48307184938124e-05,-7.61606496427573e-05,-7.50089221459247e-05,-0.00351911070927364,-0.00497542638625138,7.51162894883022e-05,-0.00488073607214185,-1.52935329433270,7.52603352436653e-05,7.48143332261044e-05,7.57095767094649e-05,-7.55840856998007e-05,-7.46771201198449e-05,-0.00316824849160113,-0.00438305199233706,7.37786441098349e-05,-0.00440529779206682,-1.23729407907449,7.57612485883645e-05,-7.59884015438378e-05,7.54734830881526e-05,7.50689813648627e-05,-7.49960364819922e-05,0.00295638234358732,0.00380270514944987,-6.99626989290422e-05,0.00381900685116290,0.798909034962281,-7.81423580860970e-05,-7.56377580529186e-05,7.69792227940142e-05,-7.49189668301419e-05,7.41477819897859e-05,
        0.0113028937098161,0.00146328618350897,0.00193686462333512,7.75214396053915e-05,0.00192751890290001,0.640072871567055,-7.74391040319360e-05,7.45896765443286e-05,7.58560257646364e-05,-7.57710787457813e-05,-7.44371721145338e-05,-0.00454797706686334,-0.00581210002366203,-7.84064243173292e-05,-0.00579138852889687,-2.28673431380023,-7.25760105958600e-05,-7.60141239152500e-05,-7.54683551165753e-05,7.50494325118199e-05,-7.52045221858062e-05,0.00321430157682666,0.00443461348956682,7.59609874177918e-05,0.00444515955362066,1.25251252454949,-7.54858409445791e-05,-7.53364831456414e-05,-7.45029560494451e-05,-7.49128619623624e-05,-7.52244654082749e-05,0.00243202670281129,0.00335100046203185,7.52675314031180e-05,0.00335945744667093,0.933877398980404,-7.62977555469582e-05,7.56255215868776e-05,-7.49974600776326e-05,-7.50652593992019e-05,-7.49348103106529e-05,-0.000315156788029723,-0.000233302454589108,-7.71826644221509e-05,-0.000367326365254077,0.0135365716993374,-7.41709474727441e-05,7.53460075220871e-05,-7.54344192244929e-05,7.51041289136233e-05,7.62380388028022e-05,
        0.209683977734161,0.000481214683975284,0.00101168358128102,7.60043896103440e-05,0.00101423514364593,-0.408992940784607,7.34380586130623e-05,-7.55292498299826e-05,-7.44340884032325e-05,-7.55144972646007e-05,-7.44715531707096e-05,-0.00371743482179283,-0.00460400511445560,-7.86078197011775e-05,-0.00460030537001582,-2.10649752474994,-7.28264589265538e-05,-7.59943156422695e-05,7.43623271576290e-05,-7.49700477499919e-05,7.47929534470495e-05,0.00320464702385170,0.00473010683200534,7.66450930061462e-05,0.00475577258957098,1.20170158471458,7.45612052630855e-05,-7.55266660096777e-05,7.56746649210236e-05,7.48834365099197e-05,7.49537850189237e-05,0.00222370490905117,0.00308071335250427,-7.52167321761373e-05,0.00313035660551822,0.828664061451077,7.42444965857516e-05,-7.50415413660832e-05,-7.48719157593696e-05,7.50027401664364e-05,7.52553443275579e-05,0.00171696661840552,0.00245508239166512,-7.46185949308405e-05,0.00243080860284038,0.679365896329805,-7.53367899141130e-05,7.52229052598193e-05,-7.52784325234674e-05,-7.53257365415133e-05,7.54284058122912e-05,
        0.185956113372227,-0.00268391867570120,-0.00350007003491050,6.91893142057827e-05,-0.00348856791825118,-2.02540531054195,7.71192520369225e-05,7.49520416191792e-05,7.38442597162163e-05,7.68501091772235e-05,7.36647608543350e-05,0.00644804004906209,0.00828977503643478,8.03930241922463e-05,0.00830875388821036,2.91985637461059,-7.90892552462386e-05,-7.42699376483068e-05,7.48376945794503e-05,-7.54968005338361e-05,-7.50959378591251e-05,-0.00351524011354148,-0.00486582165844179,7.50521688514115e-05,-0.00498745094249322,-1.52977652435545,-7.48013525102101e-05,-7.48959135192353e-05,-7.51079981756112e-05,-7.54587406224214e-05,-7.48183308973082e-05,-0.00311952810708546,-0.00436538606066378,7.31739498939894e-05,-0.00437239950373098,-1.23775335162335,-7.47160020394729e-05,7.42218887299671e-05,7.54739590471780e-05,7.49347942035455e-05,-7.48583011864290e-05,0.00297457598478605,0.00371483538351858,-7.02824864048196e-05,0.00374901655832187,0.810523523518788,-7.83999429724923e-05,-7.55542860993100e-05,7.68357257366019e-05,7.49929968931083e-05,7.40283226098309e-05};
double theta2[output_layer_size*(hidden_layer_size+1)]={-3.68096784700959,-4.00051639118305,0.835147990005224,2.00744115549235,2.07203070695876,-1.87713423285835,-1.87997462657037,1.49889180754394,1.33501107582824,-1.98876546537563,-1.89230178862912,2.15330416858858,-1.80323516040858,-0.00201915667171595,-0.00202625599980631,-2.07533290934893,1.54988893956044,-2.15122085237735,2.07296305314491,-2.21134357212458,2.11973979575160,1.29937909606143,1.08218294947573,2.13184532790980,1.98313122904363,1.76113582982947,-1.65862632759479,2.06234564501745,-1.91550286431856,-2.07150142596148,2.06154319337174,
        -1.78661562393121,5.50199499620545,-0.303044971572045,-1.38496625608124,-1.45086041187885,1.56686559795430,1.59873035659852,-0.973287154627922,-0.677362344016842,1.97712309398227,1.74420712059499,-2.20378671908615,1.68765523018328,0.000389680113992779,0.000351984368385035,1.40085294589077,-1.10871839939121,2.19041911767043,-1.43152574894548,2.26814088559523,-2.15571223784291,-4.79675429359996,-0.532526687410312,-2.17381784947016,-1.94586039686393,-1.24589645302277,1.07924965878440,-2.07074867839393,1.58123514195998,1.41053611077330,-2.07499552618728,
        -1.43177428359362,5.93757853554649,-2.10577371161221,-0.544095116962960,-0.353620372483529,-0.711666053845214,-0.823419066061288,-1.33725028307533,-3.14603722662470,-2.08541975603701,-1.38839042706252,2.48988083197565,-1.41618950302531,0.00208390771611280,0.00205962297754995,0.591402366667374,-0.460123146117417,-2.49583905147445,-0.477298778953971,-2.63523439615343,2.39148614674188,2.14353754957241,-2.18943726858724,2.43018950684068,1.90663422875874,-0.490836161095767,1.14219057352140,2.20517102240928,-0.657919657352896,0.516832201274365,2.22374404368254,
        -2.20038570162357,-5.93657978818246,0.638880616548312,-0.769330994424464,-0.905347075551604,1.21913668466062,1.26657123185592,-0.00371366168488038,1.13314746835941,1.81769292199931,1.49342327483690,-2.05475437927174,1.45449521125517,0.00369745928960192,0.00367182791802121,0.807951525827138,-0.509771488019412,2.06919868192352,-0.849204944915202,2.15678716641848,-1.99810638624086,3.50212081425626,0.634486792856021,-2.01967255682399,-1.73222842854755,-0.625540291789555,0.230461347524414,-1.89382953861671,1.22349994227881,0.841257353625963,-1.90005588184165,
        2.06615658865627,-3.83895887378609,0.303654002289612,-0.0131540704755266,-0.0612318087116194,0.214383847816300,0.230516981020150,0.122405076896742,0.443126507006496,0.424204616246256,0.309973148084694,-0.416759859771147,0.313666593503193,0.0222762523898317,0.0222672177596915,0.101764389107850,0.0239798744682104,0.485499376361322,-0.0274526276902432,0.507222472997962,-0.400278240812136,-6.94627791640740,0.298043907516835,-0.407072162499136,-0.323997563388604,-0.00248361734525157,0.00660029688967195,-0.365390176759253,0.209684358146239,0.106752815784350,-0.371395840361368};

ANN::ANN()
{
    gestureindex=NONE;
    debug=false;
}

ANN::~ANN()
{

}

void ANN::getdata(double *channelVol)
{
    double absvalue[channelNum];
    QVector<double> value;
    for (int i=0;i<4;i++)
        value.append(channelVol[i]);
    value.append(channelVol[7]);
    abs(absvalue,value,value.size());
    sort(absvalue,channelNum);
    double mean_value=(absvalue[2]+absvalue[3]+absvalue[4])/3.0;

    if (activeindex.size()==0 && mean_value<=THRESHOLD)
        return;
    else
    {
        for (int i=0;i<channelNum;i++)
            inputdata[i].append(value[i]);
        if (mean_value>THRESHOLD)
        {
            activeindex.append(inputdata[0].size()-1);
            int activeindexSize=activeindex.size();
            if (activeindexSize>=2)
            {
                if (activeindex[activeindexSize-1]-activeindex[activeindexSize-2]>20)
                {
                    reset();
                    return;
                }
            }
        }
        else
        {
            if (inputdata[0].size()-activeindex.back()>20)
            {
                reset();
                return;
            }
        }
    }

    if (inputdata[0].size()>200)
    {
        recognizor();
    }

}

void ANN::recognizor()
{
    featureExtract();
    if (debug)
    {
    for(int i=0;i<input_layer_size;i++)
        qDebug()<<feature[i]<<'\t';
    qDebug()<<endl;
    }
    double z1[input_layer_size+1];
    bias(z1,feature,input_layer_size);
    if (debug)
    {
    for(int i=0;i<input_layer_size+1;i++)
        qDebug()<<z1[i]<<'\t';
    qDebug()<<endl;
    }
    double z2[hidden_layer_size];
    multmat(theta1,z1,z2,hidden_layer_size,input_layer_size+1);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size;i++)
        qDebug()<<z2[i]<<'\t';
    qDebug()<<endl;
    }
    sigmoid(z2,hidden_layer_size);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size;i++)
        qDebug()<<z2[i]<<'\t';
    qDebug()<<endl;
    }
    double a2[hidden_layer_size+1];
    bias(a2,z2,hidden_layer_size);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size+1;i++)
        qDebug()<<a2[i]<<'\t';
    qDebug()<<endl;
    }
    double a3[output_layer_size];
    multmat(theta2,a2,a3,output_layer_size,hidden_layer_size+1);
    if (debug)
    {
    for(int i=0;i<output_layer_size;i++)
        qDebug()<<a3[i]<<'\t';
    qDebug()<<endl;
    }
    sigmoid(a3,output_layer_size);
    if (debug)
    {
    for(int i=0;i<output_layer_size;i++)
        qDebug()<<a3[i]<<'\t';
    qDebug()<<endl;
    }

    double max_value=0;
    int max_index=-1;
    max(max_value,max_index,a3,output_layer_size);
    //if (max_value>=0.5)
        gestureindex=max_index;
    //if (debug)
    {
        qDebug()<<a3[0]<<'\t'<<a3[1]<<'\t'<<a3[2]<<'\t'<<a3[3]<<'\t'<<a3[4]<<'\t'<<endl;
    }

}

void ANN::featureExtract()
{
    for (int i=0;i<input_layer_size;i++)
        feature[i]=0.0;
    if (debug)
    {
    for (int i=0;i<3;i++)
    {
        for (int j=0;j<inputdata[0].size();j++)
            qDebug()<<inputdata[i][j]<<'\t';
        qDebug()<<endl;
    }
}

    for (int i=0;i<channelNum;i++)
    {
        int size=inputdata[i].size();
        double absdata[size];
        abs(absdata,inputdata[i],size);
        feature[featureNum*i+0]=mean(absdata,size);

        double squaredata[size];
        square(squaredata,inputdata[i],size);
        feature[featureNum*i+1]=sqrt(mean(squaredata,size));

        feature[featureNum*i+2]=mean(squaredata,size)*size/(size-1);

        double mean_value=mean(inputdata[i],size);
        double deviation[size];
        for (int j=0;j<size;j++)
            deviation[j]=(inputdata[i][j]-mean_value)*(inputdata[i][j]-mean_value);
        feature[featureNum*i+3]=sqrt(mean(deviation,size)*size/(size-1));

        double waveformlength[size-1];
        for (int j=0;j<size-1;j++)
            waveformlength[j]=abs(inputdata[i][j+1]-inputdata[i][j]);
        feature[featureNum*i+4]=mean(waveformlength,size-1)*(size-1);
/*
            double zerocrossing[size-1];
            for (int j=0;j<size-1;j++)
                zerocrossing[j]=(1.0-sign(inputdata[i][j]*inputdata[i][j+1]))/2;
            feature[featureNum*i+5]=mean(zerocrossing,size-1)*(size-1);

            double slopesignchange[size-2];
            for (int j=0;j<size-2;j++)
                slopesignchange[j]=(1.0-sign((inputdata[i][j+2]-inputdata[i][j+1])*(inputdata[i][j+1]-inputdata[i][j])))/2;
            feature[featureNum*i+6]=mean(slopesignchange,size-2)*(size-2);
        */

        feature[featureNum*i+5]=AR(inputdata[i],1,size);
        feature[featureNum*i+6]=AR(inputdata[i],2,size);
        feature[featureNum*i+7]=AR(inputdata[i],3,size);
        feature[featureNum*i+8]=AR(inputdata[i],4,size);
        feature[featureNum*i+9]=AR(inputdata[i],5,size);

        /*
        int segmentpoint[segmentNum+1];
        segmentpoint[0]=0;
        double len=size/segmentNum;
        for (int j=0;j<segmentNum;j++)
            segmentpoint[j+1]=((int)floor(len))*(j+1);
        for(int j=0;j<segmentNum;j++)
            feature[featureNum*i+10+j]=powerspectrum(inputdata[i],segmentpoint[j],segmentpoint[j+1]);
            */

    }
}

QString ANN::getcurrentgesture()
{
    if (gestureindex!=NONE)
        return gesturenames[gestureindex];
    else
        return "";
}

int ANN::getcurrentgestureindex()
{
    return gestureindex;
}

void ANN::reset()
{
    gestureindex=NONE;
    for (int i=0;i<channelNum;i++)
        inputdata[i].clear();
    activeindex.clear();
}

double ANN::mean(double *channelVol, int size)
{
    double sum=0;
    for (int i=0;i<size;i++)
        sum+=channelVol[i];
    sum/=size;
    return sum;
}

double ANN::mean(QVector<double> &data, int size)
{
    double sum=0;
    for (int i=0;i<size;i++)
        sum+=data[i];
    sum/=size;
    return sum;
}

void ANN::abs(double *absdata, QVector<double> &data, int size)
{
    for(int i=0; i<size; i++)
        absdata[i]=data[i]>0?data[i]:-data[i];
}
double ANN::abs(double data)
{
    return data>0?data:-data;
}

void ANN::square(double *squaredata,QVector<double> &data, int size)
{
    for (int i=0;i<size;i++)
        squaredata[i]=data[i]*data[i];
}

double ANN::sign(double data)
{
    if (data>0)
        return 1.0;
    else if (data<0)
        return -1.0;
    else
        return 0.0;
}


void ANN::multmat(double *theta, double *x, double *y, int m, int n)  //theta m行n列; x n行1列; y m行1列
{
    for(int i = 0; i < m; i++)
    {
        double s=0.0;
        for(int j = 0; j < n; j++)
            s+=(theta[n*i+j]*x[j]);
        y[i]=s;
    }
    return;
}

void ANN::sigmoid(double *data, int size)
{
    for (int i=0;i<size;i++)
        data[i]=1.0/(1.0+exp(-data[i]));
}

void ANN::bias(double* bias_data, double *data, int size)
{
    bias_data[0]=1.0;
    for (int i=0;i<size;i++)
        bias_data[i+1]=data[i];
}

void ANN::max(double &max_value, int &max_index, double *data, int size)  //输出第一个 是max_value 第二个是max_index
{
    max_value=data[0];
    max_index=0;
    for (int i=1;i<size;i++)
    {
        if (data[i]>max_value)
        {
            max_value=data[i];
            max_index=i;
        }
    }
}

double ANN::AR(QVector<double> &data, int m, int size)
{
    double ar=0.0;
    for(int i=0;i<size-m;i++)
        ar+=data[i]*data[i+m];
    return ar;
}

double ANN::powerspectrum(QVector<double> &data, int startpoint, int endpoint)  //平均频率
{
    double delta=2.0;
    double frequencySupremum=100.0;

    double Rep,Imp,fp,p;
    for (int j=0;j<(int)(frequencySupremum/delta);j++)
    {
        Rep=0.0;
        Imp=0.0;
        for(int i=startpoint;i<endpoint;i++)
        {
            Rep+=data[i]*cos((i-startpoint)*(j+1)*delta);
            Imp+=-data[i]*sin((i-startpoint)*(j+1)*delta);
        }
        p+=(Rep*Rep+Imp*Imp)/(endpoint-startpoint)*delta;
        fp+=(Rep*Rep+Imp*Imp)/(endpoint-startpoint)*(j+1)*delta*delta;
    }
    return fp/p;
}

void ANN::sort(double *value, int size)
{
    int i, j;
    double temp;
    for (i = 0; i < size - 1; i++)
    {
        for (j = 0; j < size - 1 - i; j++)
        {
            if (value[j] > value[j + 1])
            {
                temp = value[j];
                value[j] = value[j + 1];
                value[j + 1] = temp;
            }
        }
    }
}
