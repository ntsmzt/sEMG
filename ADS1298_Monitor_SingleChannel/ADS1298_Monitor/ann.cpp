#include "ann.h"
#include <QDebug>

QString gesturenames[5]={"LEFT","RIGHT","FIST","SPREAD","YEAH"};
double theta1[hidden_layer_size*(input_layer_size+1)]={0.503210410551057,-0.00586094674182914,-0.00779712500477388,-6.59664344261701e-06,-0.00780911178745118,-3.06824475907066,5.11191196566991e-06,-2.98919124734854e-06,-2.95307164213377e-06,3.48100982227094e-06,7.92769682371661e-07,-0.00553103155252045,-0.00734765483445719,-5.09040813535205e-06,-0.00736199930018999,-2.57777731544072,6.46427303736018e-06,-4.44238454715128e-07,-1.45885286124290e-06,7.42190405873020e-07,-3.76685223680501e-07,0.000342190320144081,0.000508928896832429,-6.70100924858655e-07,0.000509731130676316,0.154515085133755,3.93811349238478e-06,1.23121575006625e-06,3.83820615430740e-06,4.35079024974959e-07,7.50066508145719e-07,0.00429389908931081,0.00570320230921798,1.05463621031761e-06,0.00571767592972998,1.79025567450486,2.35846341958740e-06,8.28403400219665e-06,2.80584726927465e-06,7.48320037922948e-06,3.64991911020214e-06,0.00198456630671614,0.00266602790628761,3.54652219260865e-06,0.00266898425079126,0.794046657783460,3.70550563954709e-06,-1.37202048167214e-06,-1.07302280527909e-06,1.24439714102141e-06,7.54995714573528e-07,
        0.613915356918708,-0.00506239781509779,-0.00660032027667104,-2.36538159164622e-06,-0.00661135129438164,-2.94742536739751,5.20195518828587e-07,-6.73420359020367e-07,-1.51178055391449e-06,-2.59654631024262e-06,1.28296039005607e-06,0.00103668604212899,0.00124241466159783,1.39466182873672e-06,0.00124341022434248,0.480304774276856,6.21300045129228e-07,9.16430551010729e-07,-3.19842523465459e-06,2.25704016392357e-07,7.28064645370403e-07,0.00253566860173060,0.00353893070613687,2.03892265415600e-07,0.00354528477437653,1.17144530252004,2.84841462549727e-07,4.91779916765162e-07,3.13295241715648e-06,2.92133877511827e-06,2.07042121500642e-07,-0.00468231680385611,-0.00711297827877200,-7.04665634942193e-06,-0.00713481772807795,-1.66004665269805,1.84183143252248e-05,6.53313095070392e-06,9.15124341201845e-08,8.46076823926169e-06,-3.32273304890947e-07,-0.00171159450929829,-0.00228842811740191,-8.94990816987743e-08,-0.00229443788573270,-0.670627529608916,2.41797811064421e-06,2.94828857337414e-07,7.07387459840740e-07,1.06021965654157e-06,3.21460481354532e-07,
        -0.305751137830759,0.00294476101156509,0.00419421957226458,5.10902810228884e-06,0.00420213848050473,2.01884983134371,-3.14981370053774e-07,-5.76507179520054e-07,-2.81951478275885e-06,7.52502615364978e-07,7.56871355724043e-07,-0.00566653049923094,-0.00732993828294590,-6.99533754358861e-06,-0.00734548546711154,-2.31539917952087,4.33422238273583e-06,8.67407052032382e-07,-1.81841183346158e-06,-7.90598538243675e-07,-1.45232446985270e-06,0.00433708531392610,0.00615843654906996,2.50714032810195e-06,0.00617366147312620,1.74376659321050,-1.15414100442702e-06,1.05471790760021e-06,1.32464054450792e-06,1.19225760731145e-06,1.91304172511323e-06,0.00401604877133626,0.00569584889093229,1.02119231143931e-05,0.00570771871490599,1.66722295276507,-2.41162997701680e-06,-1.35348608453339e-07,7.97680606304351e-06,7.26060864091404e-08,2.44939797606229e-06,0.00163097014492416,0.00222435841192483,4.11600873250664e-06,0.00223025359640616,0.748149100460960,3.70438754588273e-06,9.26292657518678e-07,7.12476614408869e-07,-1.56235328112357e-06,-4.77960198076977e-07,
        -0.636543178905124,0.00520724406069633,0.00680859444233502,4.93729743737955e-06,0.00682168501959281,2.99957543699448,-3.83747170311361e-06,-1.23868705447306e-06,1.71122067010391e-06,-5.45185503169205e-07,-1.53940369859797e-06,-0.000779943630628975,-0.000887635726239798,4.12241901077911e-07,-0.000887978510020919,-0.371861035105712,-8.19167863049463e-07,-9.66276882631341e-07,1.19648565288920e-06,-1.11111816987435e-06,1.16851560139203e-07,-0.00233625202372775,-0.00325661600354497,5.76328026117841e-07,-0.00326170881736645,-1.09357031277491,2.71795502503599e-06,-3.16351427520370e-07,1.62194466053856e-07,1.15935912412704e-07,-3.55562138921882e-07,0.00475019357419604,0.00723722046628692,1.68119328928514e-05,0.00725675267375576,1.66691374938743,-5.57582780176333e-06,-4.28037430176664e-07,1.26037616727963e-05,-6.90318775640689e-08,3.31127420334859e-06,0.00172285998040822,0.00230074298153963,9.56401526461912e-06,0.00230794664837338,0.662657270080691,-4.84001739246795e-08,-5.13039800695825e-07,1.33756998379321e-06,-1.47913178309601e-06,8.77269885358812e-07,
        -0.227814634555985,0.00315835867315960,0.00455996658148331,4.23006325779095e-06,0.00456369341327204,2.60559126376535,-3.75239038108745e-06,6.74902154093501e-07,-7.42595612343426e-07,-3.50939073068469e-06,1.27228913053593e-06,-0.00760231863528004,-0.0101115117025228,-9.02005935235633e-08,-0.0101365038602550,-2.82733983411121,4.17565551389594e-06,2.12711688500423e-07,-1.07945051193360e-06,5.69470624556747e-07,1.25829888532152e-06,0.00566551927353591,0.00795502372235494,2.68982735968620e-06,0.00797170730368666,2.43309815065173,1.25702813260867e-06,1.10222471173769e-06,1.88901641836578e-06,3.93097575004407e-06,-7.83368127008976e-07,-0.00254273118782241,-0.00401388250045073,-8.71216271076250e-06,-0.00402774258343711,-0.424910993661009,1.11679701993929e-05,3.41207013304958e-06,5.87044679977717e-06,2.65254911300530e-06,4.30894596852382e-06,-0.000686295246106036,-0.000889180676160656,2.62002782406107e-06,-0.000894013200655730,0.0673806714818476,3.22671836222401e-07,1.52037160252938e-06,3.86732476488783e-08,-1.13805208144170e-06,3.32828769241183e-07,
        -0.226826838994445,0.00316517828811072,0.00456285250603107,5.88356308182858e-06,0.00456340591088462,2.60569839273766,-4.05346165530961e-06,-1.26449703273172e-06,-3.83343456478826e-06,3.63545298262894e-07,9.38393716908114e-07,-0.00758542427480328,-0.0100896471643505,-4.78598177668287e-06,-0.0101147546339610,-2.81760863820903,4.22756839692727e-06,-2.33136925796130e-06,-2.22393117245060e-06,-6.03273462042291e-07,-3.99544150981351e-07,0.00569023132345190,0.00798733216415845,5.02443113814660e-06,0.00800326993952475,2.44378571289189,-3.40260543467778e-06,1.70855444341486e-06,2.37716754303437e-06,3.24636638183888e-07,1.25545296622256e-06,-0.00258891282104033,-0.00408067840282895,-2.95779879642193e-06,-0.00409470475039507,-0.442012333952460,1.40640230482684e-05,3.06911621246616e-06,1.61331233368769e-06,3.28999192290300e-06,5.52956490600719e-06,-0.000709186029516284,-0.000910934841870279,5.16164390885855e-06,-0.000916145924316548,0.0605753187768455,7.57393691941762e-06,-1.87542350275025e-06,-2.04550482453828e-06,1.24923824282085e-07,-2.76358417541313e-06,
        0.503220000397132,-0.00586204370093279,-0.00781720142306322,-6.02500249476943e-06,-0.00782415639345460,-3.06626102864074,3.97841389720780e-06,-6.08294977151937e-07,-4.88071776538008e-06,6.52468739176924e-08,-1.74921123486005e-06,-0.00552053488133700,-0.00734195403211070,-8.20545580819741e-07,-0.00735597410090790,-2.57421984152345,6.28949936568433e-06,-3.66301612342614e-06,-2.18231118580236e-06,-1.29138532648038e-06,-2.80650350330919e-07,0.000355774321407809,0.000514437277087420,-2.60126912843807e-06,0.000513143681440530,0.156656452322708,-6.58591956687272e-07,-1.02349826402319e-06,-5.40370590087579e-07,1.09570780424609e-06,1.89848198403420e-06,0.00428153044636530,0.00567223390604269,2.33049328470564e-06,0.00568640548468526,1.78314487571907,3.59174535773535e-06,2.71832005808545e-06,1.35343903432938e-07,3.79256933453216e-06,2.21525289639389e-06,0.00198557596683094,0.00264257587797747,4.85353974103433e-06,0.00266633386589807,0.791318311274703,6.13178157628371e-06,-1.12017840326754e-06,-1.12639797382394e-06,7.42450445609089e-07,1.32669065652781e-07,
        0.210570932978726,-0.00303656899424627,-0.00436959185562248,-3.99543766832024e-06,-0.00437341544135456,-2.55859392055503,2.80377732580030e-06,-1.41087471528761e-06,-1.61654912365599e-06,-1.44351949618081e-06,4.56428333262000e-07,0.00779250909972347,0.0103760937645588,5.78945544987593e-06,0.0104016731982619,2.91102772981581,-1.48155170620484e-06,-6.64188455401931e-07,-4.67970226077395e-06,5.49823209905743e-07,-1.47602926399825e-06,-0.00538317349291234,-0.00755135147844998,-2.60848034017611e-06,-0.00756687758424894,-2.31823826635579,1.45615819756954e-06,1.96593343708920e-07,3.03573459182116e-06,1.37542062584240e-07,-1.68283564983909e-06,0.00253636753763286,0.00402244218552276,2.02871594315195e-05,0.00403740336271589,0.409718037515532,-6.75153885995893e-06,5.50918186102161e-06,8.27043441457642e-06,5.06783166556500e-06,4.94473955765464e-06,0.000666395836493844,0.000862448310631990,8.60554246848293e-07,0.000868276328944697,-0.0820994213898218,-1.02870914034605e-06,5.04774151216535e-07,-3.00469962534414e-07,-1.22249013486067e-06,6.41711413400885e-07,
        0.316926820728767,-0.00374274171995445,-0.00489295228395030,-3.84305262416061e-06,-0.00489593224539118,-2.76399848048809,3.83213145711184e-06,1.42177801009338e-06,1.76912662967178e-07,-2.49650421635429e-06,-8.88925329640970e-07,0.00436273447656296,0.00592428056379462,1.26581436687374e-06,0.00593790154185709,1.62423825476388,-4.08016584739382e-06,-8.23903886293164e-07,-4.78704671870342e-07,-2.91910478217882e-07,-1.38692781194626e-06,0.00168141235649809,0.00235754973125492,7.92952140249003e-07,0.00236459043928389,0.646259812501987,-7.76526903613086e-07,9.81448973617236e-07,-4.90778074374331e-07,7.47679818105043e-08,5.43560940322087e-07,0.00161566788846805,0.00232810816538459,1.22901401457924e-05,0.00233599254038222,0.247042114819718,-5.31214386718582e-07,1.73545098013965e-06,4.32231165063220e-06,6.01005229341975e-07,6.60564055486933e-07,0.000415792328568259,0.000538563293896795,-1.88091338935190e-06,0.000539862809113793,-0.0993799531884011,3.66382699764634e-07,-1.67711326612669e-07,-2.61878069202241e-06,6.36135709072152e-07,-7.33831956115603e-07,
        0.310444057878009,0.00118888567842647,0.00103568522932358,2.41007145221259e-06,0.00103388266813865,0.940298216780758,1.39879705114226e-06,-1.91839763384565e-07,1.74494707908323e-06,-1.10613819161820e-06,-7.70852124289329e-07,0.00200306102120721,0.00231436119508121,6.71128532408908e-07,0.00231832096417370,0.946731858257695,6.23063393557139e-06,8.92590924666498e-07,-6.92542208100316e-07,-1.52429659830866e-06,-1.27463098514042e-06,-0.00851452716829237,-0.0120931814557886,-6.03628230904133e-06,-0.0121209154896427,-3.45252985815980,1.42166480298229e-06,-1.91019277947578e-06,3.34580427958898e-07,2.63329109853119e-07,-1.16812006436898e-06,-0.00510688115854338,-0.00717583924633404,-9.43240988205986e-06,-0.00719546464684444,-1.75865901870053,7.70774547578910e-06,7.70622453630570e-06,-9.79551815742762e-07,6.89256894998500e-06,2.49658206330761e-06,-0.00184472989568743,-0.00254196919490001,-3.41517295624689e-06,-0.00254885490540733,-0.587324119758345,-3.92891195212532e-07,9.35700348361072e-07,-1.51192320983737e-06,-5.76757623349619e-07,-1.99498127730195e-07,
        1.08001268025877,-0.00123771977453730,-0.00166836634514867,-3.13596023453777e-07,-0.00167783851802095,-0.000311327975394443,1.00719926680848e-06,-1.04048239454471e-06,-2.02608876267414e-06,-5.09624860002568e-08,-2.62656508184491e-07,-0.00370392719955404,-0.00530785207623793,-3.60178492573527e-06,-0.00532382207801477,-1.21340171039365,7.80654644045777e-06,-2.18593726415584e-06,-2.04138846622297e-06,-8.74960751123627e-07,-1.15290928788055e-06,-0.000379069179625509,-0.000598676848561776,-1.01771629012277e-06,-0.000602415838141512,0.0623186206184052,-9.06545709359976e-08,7.88070010088606e-07,1.55054289342597e-06,4.85130642270164e-07,4.36585345467393e-07,-0.00933742412546433,-0.0138445619604362,-2.24213865323011e-05,-0.0138836369048051,-2.91783032678954,1.95894150415756e-05,1.07135491669950e-05,-5.23858699148166e-06,7.25195757473632e-06,7.99247418288750e-06,-0.00318664405916948,-0.00428361071391850,-6.95545200443064e-06,-0.00429841207221254,-0.917469544479462,2.69496228010391e-06,-3.37110883779620e-07,-3.23671371861462e-06,6.80737557325904e-07,-7.42916371228560e-07,
        -0.522184828517894,0.00471603287352917,0.00625006897227959,5.17172469494850e-06,0.00626467268323614,2.00173704117364,-7.03173799131448e-06,2.33948166261929e-06,5.16561478091613e-07,2.67347616606443e-07,-3.94480623298649e-07,0.00642769710554033,0.00875668676231800,8.99502672153543e-06,0.00877640536045642,2.63339813111135,-3.09380982278755e-06,-7.58589842462561e-07,-1.57182735768832e-06,-2.19155448235939e-06,-5.23084281943321e-06,-0.000737108009537882,-0.00100631594352930,4.12200282990755e-06,-0.00100367217024290,-0.454310509391672,-2.29713719059883e-07,-1.28456600120083e-06,1.43985059831070e-06,-5.10600965117989e-07,-1.46189011388242e-07,0.00286058441761850,0.00472602714772275,2.95095035522016e-05,0.00474163163367294,0.551410175863992,-1.14532812897817e-05,4.58589276675343e-07,1.51210961771766e-05,-1.48426609652310e-06,2.40977386197792e-06,0.000604448300866377,0.000801844196905876,5.02590389032545e-06,0.000805628779846297,-0.00280065058786435,-2.63045565452591e-06,7.58370545206406e-07,1.90039322241992e-06,-3.05448390455195e-06,1.30196721080939e-06,
        0.310372850528997,0.00118630612665892,0.00103597170971097,2.06318709734339e-06,0.00103428412506626,0.940215692609911,-3.37586296594229e-06,-6.04736574428991e-06,6.53011533355962e-07,1.08573966523905e-06,6.43546686978587e-07,0.00200312041522744,0.00231499023447916,-6.54032343997887e-07,0.00231899094919008,0.946765990472251,7.27004727842002e-06,-9.81529518617825e-07,1.43218045551380e-06,-6.45940709236455e-07,2.26425009653013e-07,-0.00851019191627559,-0.0120878223219453,-8.03808692540379e-06,-0.0121160005239513,-3.45277700068127,4.61110839987793e-06,9.09052842008361e-07,-5.11906200148848e-08,5.75444228199299e-08,1.15889157349412e-06,-0.00510365345486144,-0.00717243348674846,-7.94932670403769e-06,-0.00719268871221013,-1.75799875134972,4.06488926058070e-06,4.43003229793235e-06,2.43670722586870e-06,3.35964144143065e-06,1.95981253939054e-06,-0.00184296448020827,-0.00253807510940340,8.75404205712610e-07,-0.00254556298824773,-0.587103076224678,2.58430899813008e-06,4.44227032402671e-07,-1.02219559979596e-06,1.57074607248831e-07,-8.39019041713762e-08,
        -0.0873631760744804,-0.000907733602536013,-0.00134249508251600,-4.98353908981777e-06,-0.00133486627149121,-1.55509994469998,-4.41256006053699e-07,-2.08909537640484e-07,-2.16380997383222e-06,4.24587388012214e-06,1.44373589485641e-06,0.00910174475527757,0.0122652450796784,1.41790150636884e-05,0.0122946886536558,3.54329207333327,-5.16497406264812e-06,1.50334441544018e-06,2.19197488392466e-06,1.01999307883310e-06,8.38011970595287e-07,-0.00167501038717791,-0.00230662983049827,1.61621793474647e-07,-0.00231082410601877,-0.813449282710845,1.38474216238960e-06,-1.35079185968266e-06,-4.51120518777134e-07,3.19084995456936e-06,2.51625546018898e-07,0.00271274155481069,0.00433119021591300,2.97760602227362e-05,0.00434701590419329,0.339892575858026,-7.08518816307794e-08,-7.46526039837503e-07,1.12478510774580e-05,-2.48461987174768e-07,1.64706931037933e-07,0.000544037472542931,0.000700146695162175,4.43490332841756e-06,0.000703942778699647,-0.184505960023101,3.92364396239771e-07,-1.39475317819617e-06,-1.00718961343459e-07,7.90438896008574e-07,1.05503843435047e-06,
        -0.523330046364224,0.00472620200271455,0.00626134454241410,1.03616777210376e-05,0.00627584787734667,2.00795155758463,-4.24173826303240e-06,2.64041448117441e-06,-4.65363076744177e-06,-8.95612993791084e-07,9.51757776112429e-07,0.00644363945309642,0.00876870036980528,1.05005489675496e-05,0.00878924639686890,2.63688795804049,-1.30899052859410e-06,-1.21994216526702e-06,-1.35189214044814e-06,-1.62291264929477e-06,2.07674544312877e-07,-0.000738020014425378,-0.000996737232408394,-1.55573003433045e-06,-0.000997679123458693,-0.451432661586692,6.28710916825749e-07,-1.32556999395407e-06,1.55962311138426e-06,-3.12483769804180e-07,1.08513829691348e-06,0.00286647589693330,0.00472685665216293,2.91832654610690e-05,0.00474216985939454,0.550746449368589,-1.03329771026113e-05,-7.03385580488135e-07,1.76505884258550e-05,-3.28932560511178e-06,4.41053588921086e-06,0.000600227526589790,0.000799599557538377,2.47143596039885e-06,0.000803085476015861,-0.00333046202247490,1.84400025464563e-06,-4.16929611748459e-07,4.75192309402881e-07,9.98113970418545e-07,7.33614412638711e-07,
        -0.307475019022797,0.00295932564166604,0.00421741881339870,5.36176305527250e-06,0.00422621050181362,2.02737527298984,-1.23609555405477e-06,4.59573853487331e-06,1.41723658745653e-07,-2.08836486226985e-06,-1.05580330783914e-06,-0.00565868892691838,-0.00731851251709082,-3.18324468787037e-06,-0.00733418122552475,-2.31050513338831,7.14421368338409e-06,-1.79161298174192e-06,-1.19154589276521e-06,-1.97127318374883e-07,-6.01701016661477e-07,0.00437302916022935,0.00620412741508571,2.39990409455574e-06,0.00621923652821256,1.75769621367691,-5.81677548192579e-06,-5.14922091198959e-07,1.87623824399401e-06,1.75521392595037e-06,1.64795283145794e-06,0.00398034291805211,0.00565490892009355,1.42334117888199e-05,0.00566672867392189,1.65755309296087,1.32016881590111e-06,3.81345342279906e-06,8.18049991348181e-06,9.06845160959368e-07,-5.07166747812218e-08,0.00161822300595553,0.00221999596288417,5.53397319805397e-06,0.00222530256783842,0.744223263726745,2.40129021561444e-06,7.48457269998166e-07,3.09404813664964e-07,-2.12328097671898e-06,-1.56312093524419e-06,
        -0.523570948561832,0.00475548817770888,0.00629937551153657,9.06437350817795e-06,0.00631369974125347,2.03178254163387,-4.87120824344844e-06,8.62467608507981e-07,-7.29537898909426e-07,6.69377744327935e-07,-3.93990306727177e-07,0.00638235560144271,0.00868648945715605,1.12625611918183e-05,0.00870704095620783,2.61393097803268,-3.87381729518119e-06,-1.55321050490281e-07,1.11313092407946e-06,1.10988045315314e-06,-3.24596780356554e-08,-0.000770088298587738,-0.00103634618953185,5.99284344339314e-07,-0.00103698474645954,-0.462531455451139,-1.56639937702064e-06,1.31891199862257e-06,-9.92938209401313e-08,4.47173660446249e-07,-2.07432542200796e-06,0.00285629388247723,0.00471032220442331,2.61651819031426e-05,0.00472582833187179,0.551103857178326,-9.06223831741806e-06,-3.62809648777006e-06,1.36629034498921e-05,-3.25372165081319e-06,6.35755540514903e-06,0.000601222549889487,0.000797548438775504,3.53093369191909e-06,0.000800133007562417,-0.000720716625805996,-1.57326048549325e-06,-1.69131043760297e-06,-1.50288346308453e-07,9.63983751636385e-08,1.38331839228341e-06,
        -0.0664204329045096,-0.00104637237759881,-0.00153656308853250,-2.51582477659921e-06,-0.00153232331116434,-1.62404952941644,-4.77132807922141e-06,-1.68757094522451e-06,-5.59138721689944e-06,-1.14391158203691e-06,-1.09275971168244e-06,0.00902383579277981,0.0121426340145749,6.66130559451689e-06,0.0121719115187401,3.50325602979399,-1.01035220545667e-05,2.03524322588947e-06,1.35819902802776e-06,-2.98749761927405e-07,-2.42681452926688e-06,-0.00186485637764574,-0.00259393905451011,1.42759556787452e-06,-0.00259887763105331,-0.895445887423901,-1.53843710457892e-06,-1.02622740468339e-07,9.67772912979551e-07,1.11530333317076e-06,6.83438491281616e-09,0.00269121294348604,0.00429007978245441,3.01171862755347e-05,0.00430576737828362,0.339284202371086,-2.03204834277481e-06,-2.17365644666212e-06,1.00558760601682e-05,-3.16148633880731e-07,8.50209949673597e-07,0.000548586788229223,0.000699302296383511,6.73753312364985e-06,0.000704085676927344,-0.180197351735728,-1.89362386284416e-06,1.32236918584480e-06,-7.67481526687250e-07,1.13877987134720e-06,-7.55502811583033e-07,
        -0.520005295152358,0.00599454525916051,0.00798757251202833,6.68088584177137e-06,0.00799895403584191,3.12379983199515,-6.30096447205016e-06,2.76996603328442e-06,-5.84941920693935e-07,8.59605597128017e-07,4.36828353591875e-09,0.00571384848373783,0.00759665057865341,6.90354471758732e-06,0.00761175018577886,2.65732502151898,-2.26346233676617e-06,1.99032019940180e-06,3.37414689213986e-06,-1.04867034763798e-06,-3.30096795750493e-06,-0.000197426877223262,-0.000286771052615881,2.69338316969927e-06,-0.000287281780411650,-0.0922335243072097,-3.97592230993328e-06,-8.05786387620573e-07,-8.17184880168006e-07,-4.80670817539749e-07,4.01745589311765e-07,-0.00434130337739208,-0.00575232701346740,8.42918097891967e-06,-0.00576686876979972,-1.81718093770173,1.36210602417632e-06,-6.28667304020684e-07,9.85359200128608e-06,1.51474644416932e-06,1.20052099280481e-06,-0.00201753581445576,-0.00269546725948806,1.97472467770832e-06,-0.00270301907128580,-0.811069795863076,3.94886058643959e-06,1.65197301856388e-06,3.78858476143063e-06,4.65406808903928e-07,1.08085001432483e-06,
        -0.323592022006832,-0.00111739900591039,-0.000929052675234357,9.95683619396117e-08,-0.000927526603576961,-0.909704996494674,2.10737285977145e-06,-5.43326205861807e-06,-2.69271931633794e-06,-1.65512884642324e-06,-5.01126892056227e-08,-0.00198650800602938,-0.00227410956804211,1.59354904490324e-06,-0.00227815871354820,-0.936152221028198,3.27774803395322e-06,1.37293911846481e-06,-1.37305781645242e-06,7.24617307644296e-07,-3.57366028673113e-07,0.00872580824996873,0.0123861277259413,5.99245732698169e-06,0.0124152827062322,3.53662454212176,-4.89307585780705e-06,-8.45247461345978e-07,-3.37509345479212e-07,-1.74988799881108e-06,-1.32063018616915e-06,0.00516261157790380,0.00726165439627242,2.01831216117671e-05,0.00728292294638239,1.77261784392150,-3.14576989225981e-06,3.31851586403027e-07,7.37036354832549e-06,1.22131272736107e-06,8.79513116430170e-07,0.00186138315837884,0.00256175386903066,2.29619501864736e-06,0.00256380260493174,0.589399756212209,2.84832964853182e-06,2.38775447108674e-06,3.08960384889011e-06,5.22710404119220e-07,1.21533967922757e-06,
        0.502887573176118,-0.00585906703366721,-0.00780282693656654,-3.73899297954636e-06,-0.00781178335620096,-3.06706482490999,3.60326277936797e-06,-1.54360556960469e-06,-2.02117977449106e-06,1.74519645000468e-06,-1.07127123361081e-06,-0.00552591567493372,-0.00734176304006875,-3.16364697911993e-06,-0.00735593361467313,-2.57595193791482,1.47035212466171e-06,-2.20672446362889e-06,-4.82016625838758e-06,2.33374725186305e-06,7.69276611601647e-07,0.000366681204490350,0.000514510104548869,9.26216269585998e-07,0.000515824436777926,0.156449552746654,2.18085152886578e-07,2.52560829008652e-07,-1.03618708237339e-06,1.38376523466404e-06,4.50130949846031e-07,0.00428756736106087,0.00569881595424004,1.58323375130839e-06,0.00571309027371438,1.78910778154372,3.13920482186992e-07,6.25877399994676e-06,-1.18450008996581e-06,3.96477740214239e-06,4.57380073361816e-06,0.00199452333751230,0.00265473484509906,2.13924887946601e-06,0.00266052366913555,0.793454514296168,4.06051466034482e-06,1.83817941377922e-06,-8.14299519606269e-07,-3.00247404111038e-07,2.38400209300009e-07,
        1.07840758238690,-0.00123328062197153,-0.00166279362643546,-2.32332968619548e-07,-0.00167243186648078,-5.61018675512086e-05,5.68528948025954e-07,-1.21894659900787e-06,-3.18581304180154e-06,1.40521687791442e-06,3.49406654034731e-07,-0.00368512136658163,-0.00528408804318141,-5.02383545309451e-06,-0.00529959621486005,-1.20691088338330,1.37473546343592e-06,1.27287720428967e-06,-2.03154343106614e-06,3.61162079104613e-08,6.90383788281361e-07,-0.000355103672195726,-0.000588206901279493,-7.26557867205681e-07,-0.000568394316453480,0.0637029985001238,1.95504368070479e-06,-2.64175105018825e-07,-1.61566134916056e-06,9.31500372266133e-07,2.45518862032400e-07,-0.00932601510221245,-0.0138278756379609,-2.45912219285743e-05,-0.0138672497599615,-2.91569237995645,2.10263831502475e-05,8.39119221734476e-06,-4.62180563090506e-06,3.45670864535910e-06,6.84802129979787e-07,-0.00319339251655096,-0.00428002209802375,-5.62112513416243e-06,-0.00429181932358367,-0.917322244785523,5.78187327709990e-06,-4.31722094474979e-07,-3.80704926654905e-07,1.08413602897510e-06,8.26347191876449e-08,
        0.503098384300099,-0.00586024102354637,-0.00779706612320796,-1.14971499238669e-05,-0.00780937076478888,-3.06776486794084,3.75260440017701e-06,-8.62877848352476e-07,-7.50372662336606e-06,5.41155148841514e-07,-4.57421749741983e-07,-0.00553008841381809,-0.00734710762061994,-5.95651156707486e-06,-0.00736132405486439,-2.57728416683606,5.31078758985750e-06,-2.83210847779906e-06,-5.08711460743644e-06,1.93765218513303e-06,-1.36420855826385e-06,0.000348403890922456,0.000512653587151900,-4.93982262800517e-07,0.000512740095852588,0.155597722918930,1.21249430969408e-06,-2.43884858015675e-06,-2.54117838566781e-06,7.84424320357208e-07,-1.22024010162819e-06,0.00429826184489625,0.00570115952049580,3.28940420773150e-07,0.00571522300385397,1.78973451827376,7.03132418755685e-06,2.08887793849004e-07,1.64794977858357e-07,2.84587102212571e-06,2.48459751689863e-06,0.00199677076852966,0.00265600393073933,-3.47554768056385e-06,0.00266323875427086,0.793803763417274,3.51457156367856e-06,-1.62183549379136e-06,-3.41976998075727e-06,8.62026796207236e-07,4.58250767758038e-07,
        0.113593874688297,0.00113783596433199,0.00103673562323629,2.20284598414793e-06,0.00103975850777316,0.380808625453244,2.71513081899794e-06,-4.11915171005997e-06,-5.30614419557713e-06,-4.50578284734310e-07,-1.62097255616668e-06,0.00422526027980870,0.00553937707271818,1.30544157633165e-06,0.00555446760367892,1.59947565510033,2.71236710398839e-07,-6.64214522283057e-06,-6.38155000262094e-06,-8.89261481306119e-07,-2.16781665269496e-06,-0.00790430775356384,-0.0111367907865268,-4.27325368280397e-06,-0.0111599841048088,-3.34345768171353,4.28996232559191e-06,-2.08699370267969e-06,-1.91856202331746e-06,1.75864559226275e-06,-3.16405222483796e-06,0.00148459074306580,0.00254239911755724,1.64793375634376e-05,0.00255256943447067,0.301979754572976,1.94226731403187e-06,-3.18414324208321e-06,8.71110646908555e-06,-1.34287810925961e-07,1.61957002834102e-06,0.000436805642686110,0.000512256921815383,1.75409312698682e-07,0.000515313552150344,0.0492047667602254,-1.11337972675674e-06,9.67538477984127e-07,-1.07948978302400e-06,1.00068250542295e-06,6.60884992711889e-08,
        0.211072694974644,-0.00303477230967662,-0.00437063114608589,-5.56921889734858e-06,-0.00437444463192070,-2.55744786555692,3.50927614954766e-06,-1.74564824403023e-06,-3.78521187347609e-07,1.71078453505137e-06,-1.38473659736582e-06,0.00779155359367068,0.0103744570598174,8.49493008119978e-06,0.0104002359868628,2.91169089127165,-2.18395279033663e-06,1.78378405783403e-06,-4.26121215125376e-07,-4.34946603638970e-08,9.53770782291075e-07,-0.00537710914266819,-0.00754476173096223,-2.49733737835098e-06,-0.00756020448841289,-2.31524921311937,1.69514726221030e-06,-2.07872860095153e-09,7.46694443594630e-07,-6.84893642185053e-07,-1.50107146266233e-07,0.00251676417253716,0.00399358072581606,2.10042910461897e-05,0.00400841190819374,0.403019431040238,-2.75416926898386e-06,5.30268485757489e-06,6.39417099431419e-06,-9.63485494487713e-07,3.77945004441851e-06,0.000659163831609128,0.000855265872195899,2.72635235208267e-06,0.000859933064220839,-0.0844333578153993,2.83060704129142e-06,-2.34456311573805e-06,-7.59970251312110e-07,9.47127649986404e-07,9.41036308689399e-07,
        0.609939404951456,-0.00502241286629076,-0.00655200034791512,-5.05947842476900e-06,-0.00656522166079121,-2.92551837032498,-1.22859151224180e-06,-5.46743778213606e-06,-2.48715421805808e-06,1.63251486479993e-06,1.25776175323724e-06,0.00102379671741140,0.00122815664949961,1.19750576751809e-06,0.00122902417970143,0.475734117322048,-1.98576580302599e-06,-1.46776390551275e-06,-6.85874354460938e-06,1.41536027786688e-06,1.36561281229401e-06,0.00253955486743994,0.00353921528604154,-2.41792190911699e-07,0.00354675496185717,1.17133729485699,-2.44967188162587e-06,5.56357560689652e-07,9.50215978116863e-07,-1.26497892745882e-06,-2.92255351095536e-06,-0.00464948816675573,-0.00709008561504733,-9.27573579448115e-06,-0.00710903463957169,-1.65365510751608,1.81617561909638e-05,3.64463372119100e-06,-3.69406926067653e-06,4.89245163444040e-06,7.87784686254899e-07,-0.00171511969730419,-0.00228745920952956,-6.47227527505121e-06,-0.00229516568653067,-0.667714320488021,1.35285659255238e-06,6.65878234645535e-07,-3.16307517221807e-06,6.52360656748330e-07,-8.67425276208260e-08,
        -0.636970424559162,0.00520436380470079,0.00680702282388888,4.76883884495276e-06,0.00682019222416129,2.99654693723483,-4.86561423680214e-06,5.42937105538268e-07,8.27467974778014e-08,-5.51130353132794e-07,-5.92781013366606e-07,-0.000774955422201378,-0.000879843572478625,-1.98354947294670e-06,-0.000880200011228487,-0.370257212631519,1.01836912333094e-07,1.57337970356486e-06,-1.34884517873755e-06,-1.02268706339489e-06,1.18334652480765e-07,-0.00233519706726632,-0.00325447786521749,-2.78062252951090e-06,-0.00326149527835186,-1.09348815475546,-8.62286651394668e-07,1.33869062565604e-06,1.93435253541129e-07,-4.98364663454375e-07,1.26264784990143e-06,0.00476498620647973,0.00725789696094529,2.15305708870130e-05,0.00727732038370056,1.67132237726457,-3.79648892272319e-06,-1.47803005085442e-06,9.74218322978271e-06,-3.95020926444928e-06,5.24197944814901e-07,0.00172534549845590,0.00230510944342196,4.63283755014568e-06,0.00231102734609771,0.663991306178147,-4.76906828208543e-06,3.21605423320319e-07,1.10194330764741e-06,-2.36168770777135e-06,4.71667927773546e-07,
        -0.226445327794864,0.00315969742475302,0.00456063349886835,4.41557416107906e-06,0.00456150188147709,2.60649906603679,-3.96325208190712e-06,1.14975521951506e-06,-1.15702913016574e-06,-1.43302461583290e-06,4.71986345682606e-07,-0.00759427293078445,-0.0101022319806607,-6.31220920287114e-06,-0.0101277011018429,-2.82132174328427,5.34094957949272e-06,-6.71969250917017e-07,8.60121783147645e-07,-4.63246001363957e-07,-5.02774987655956e-07,0.00568376353915352,0.00797987227175731,2.54294760835969e-06,0.00799631631030052,2.44165603812405,-1.29949642619511e-06,1.44303163000819e-06,2.34604477341161e-06,-1.70510676705641e-06,-1.23725196560390e-06,-0.00259300545713913,-0.00408795671507036,-7.74439470940416e-06,-0.00410215249915231,-0.442894344824234,1.30315721625782e-05,3.25434228664223e-06,5.41150065480237e-06,1.13536924318980e-06,3.32021525067128e-06,-0.000705191521917539,-0.000910981662087036,5.55671095728481e-06,-0.000917262950039923,0.0607011380732728,6.42131205774575e-07,2.36089017072866e-06,-1.48332523309929e-06,-1.72492341145148e-06,-1.69660590380979e-07,
        1.07957729698499,-0.00123690984698398,-0.00166760056534119,-5.32984406133990e-06,-0.00167723313159586,-0.000487325906748333,6.65045355633932e-06,-6.04734488842486e-06,-3.82875390896427e-06,7.50139608451361e-07,1.55666211226762e-07,-0.00369001039319363,-0.00530351927655556,-3.17289554565024e-06,-0.00531721805670846,-1.21198804964093,6.07140446527567e-06,-8.53853332720042e-06,-4.61885437227137e-06,1.26833749798324e-06,1.00648298815489e-06,-0.000375173057308665,-0.000595974477399766,-2.85275734926558e-06,-0.000599449191747603,0.0623049520438771,2.99911475031041e-06,-1.55039398997293e-06,-1.45901943624982e-07,1.11779682838789e-06,1.26748751810167e-06,-0.00933303219226295,-0.0138399288881416,-2.43622976025066e-05,-0.0138787492111135,-2.91703382449030,2.88693872324559e-05,7.40435513037241e-06,-2.16898491087634e-06,5.37964553579253e-06,2.56856636242650e-06,-0.00319104614070479,-0.00428285061794217,-4.28018011288251e-06,-0.00429554773621118,-0.917358599634050,2.17189526194596e-06,-3.07773518197295e-06,-1.13571738771607e-06,1.44764646242998e-06,-5.52270312604889e-07,
        -0.307157355833920,0.00295703231334104,0.00421155339017313,3.97215312332765e-06,0.00421878761082108,2.02506856229692,-3.72817317648886e-06,2.43261107777131e-06,7.99890003777033e-07,2.77034956111033e-07,1.33257632432732e-06,-0.00565685639367368,-0.00731647184712169,-3.22853401489261e-06,-0.00733280168647509,-2.30987251303399,2.42826907368471e-06,-1.88712310771678e-06,6.92525937430371e-07,1.05868221261911e-06,1.73712150844305e-07,0.00437257651262063,0.00619997213955057,2.59548852613854e-06,0.00621422694754017,1.75623903642538,-8.69839740647413e-07,1.03735544535062e-07,1.33923133333278e-06,-1.55445262357729e-06,-9.48148511807110e-07,0.00398562844100161,0.00565819181745804,1.75908266565835e-05,0.00566997191899834,1.65794001355276,-2.34672064155220e-06,-1.58075798207972e-06,9.57012210092073e-06,1.22631903942686e-06,-8.73677002583460e-08,0.00161847171390652,0.00220814750463488,4.94778872642432e-06,0.00221440824758020,0.744311283800431,-1.90283626732080e-06,2.16541270871643e-06,2.27331607927255e-07,-1.42987746350683e-06,-1.58455379777661e-06};
double theta2[output_layer_size*(hidden_layer_size+1)]={-1.34890918638455,-2.73960555253214,1.33823823381802,-2.68166123477864,-1.26543594666169,-1.97273127710739,-1.95489208983620,-2.73269431951651,2.03958250322811,1.15385217634134,1.59484252065638,0.597731579606451,1.57960329529143,1.59449523062452,2.49586643932028,1.58231854956681,-2.67293274180924,1.56454642610471,2.47004682683937,2.80867639364770,-1.59354264153667,-2.73766233235369,0.602072862568086,-2.73896235200795,1.02808453183917,2.04417636192077,1.33049768310255,-1.26687402263339,-1.95721568206754,0.598602643004121,-2.67260510549653,
        -2.97571524217032,1.43305151943278,1.48806623620203,1.55597538716831,-1.49610019167607,2.63966619101728,2.64751205407116,1.43442928208777,-2.60482299775246,0.119870721754146,-2.58607791394802,1.34307992429474,-2.00714804363416,-2.58643650420717,-2.01361597533517,-2.00767260859565,1.56424775578973,-2.00888647342033,-2.03983135795692,-1.43048932185805,2.63090621902138,1.43363889456671,1.34054199988527,1.43364975503759,-3.18965670617683,-2.60131332958422,1.48476084937166,-1.49743900420575,2.64781806733516,1.34226478528875,1.56323846596727,
        -2.47846180831034,1.66917735160796,-0.918982639147074,0.508543425941377,0.919537354704518,-1.46197698350152,-1.47674359330447,1.66323180027138,1.43658370128470,0.833327573266441,-1.09363407423109,-2.57292770059687,0.462191387280950,-1.09302503228145,1.09371493398069,0.460611999209562,0.497994121984105,0.454927541666653,1.11067509393906,-1.69747139851613,1.09079876540006,1.66808664585155,-2.57074026422179,1.66861633107802,0.766269154476908,1.43024134818661,-0.918158989504557,0.924130951776758,-1.47803469144479,-2.57199277538442,0.498992624467948,
        -2.66776652292220,-1.96487313630106,-2.72718418470151,1.64597065026728,2.71329055603899,2.27298354373027,2.26939869237709,-1.96415505163722,-2.29133249174995,-2.95102713301786,1.70042329921858,0.621599370604442,0.944824645128562,1.70033659128129,-2.09918069023014,0.948099095627898,1.64850358609682,0.977681922005458,-2.11909756844160,1.97093645984489,-1.70458349181076,-1.96500206722199,0.618640354241803,-1.96491888718424,0.817140609593393,-2.29043712710796,-2.70848454417102,2.70956535755482,2.27204946507462,0.620883977460012,1.64677838817722,
        -2.82085647233059,1.97763082541352,1.13267846106868,-1.82975676309689,-1.25823508815603,-1.70359337568672,-1.70771165832694,1.97627484129404,1.57247135344072,0.306603434369954,2.00527253672943,1.39108555785937,-1.97624279881874,2.00521551501643,-0.167795234837322,-1.98257008363612,-1.84206949425232,-1.97869039935232,-0.0626390378049252,-2.07602051402333,-2.08863680800100,1.97531135549129,1.38556823543750,1.97662104831333,1.26622661666952,1.57231498497995,1.12098514523983,-1.25889652681464,-1.70492656792569,1.39023936873388,-1.84026740895462};

ANN::ANN()
{
    gestureindex=NONE;
    debug=false;
}

ANN::~ANN()
{

}

void ANN::getdata(double *channelVol)
{
    double absvalue[channelNum];
    QVector<double> value;
    for (int i=0;i<4;i++)
        value.append(channelVol[i]);
    value.append(channelVol[7]);
    abs(absvalue,value,value.size());
    sort(absvalue,channelNum);
    double mean_value=(absvalue[2]+absvalue[3]+absvalue[4])/3.0;

    if (activeindex.size()==0 && mean_value<=THRESHOLD)
        return;
    else
    {
        for (int i=0;i<channelNum;i++)
            inputdata[i].append(value[i]);
        if (mean_value>THRESHOLD)
        {
            activeindex.append(inputdata[0].size()-1);
            int activeindexSize=activeindex.size();
            if (activeindexSize>=2)
            {
                if (activeindex[activeindexSize-1]-activeindex[activeindexSize-2]>20)
                {
                    reset();
                    return;
                }
            }
        }
        else
        {
            if (inputdata[0].size()-activeindex.back()>20)
            {
                reset();
                return;
            }
        }
    }

    if (inputdata[0].size()>200)
    {
        recognizor();
    }

}

void ANN::recognizor()
{
    featureExtract();
    if (debug)
    {
    for(int i=0;i<input_layer_size;i++)
        qDebug()<<feature[i]<<'\t';
    qDebug()<<endl;
    }
    double z1[input_layer_size+1];
    bias(z1,feature,input_layer_size);
    if (debug)
    {
    for(int i=0;i<input_layer_size+1;i++)
        qDebug()<<z1[i]<<'\t';
    qDebug()<<endl;
    }
    double z2[hidden_layer_size];
    multmat(theta1,z1,z2,hidden_layer_size,input_layer_size+1);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size;i++)
        qDebug()<<z2[i]<<'\t';
    qDebug()<<endl;
    }
    sigmoid(z2,hidden_layer_size);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size;i++)
        qDebug()<<z2[i]<<'\t';
    qDebug()<<endl;
    }
    double a2[hidden_layer_size+1];
    bias(a2,z2,hidden_layer_size);
    if (debug)
    {
    for(int i=0;i<hidden_layer_size+1;i++)
        qDebug()<<a2[i]<<'\t';
    qDebug()<<endl;
    }
    double a3[output_layer_size];
    multmat(theta2,a2,a3,output_layer_size,hidden_layer_size+1);
    if (debug)
    {
    for(int i=0;i<output_layer_size;i++)
        qDebug()<<a3[i]<<'\t';
    qDebug()<<endl;
    }
    sigmoid(a3,output_layer_size);
    if (debug)
    {
    for(int i=0;i<output_layer_size;i++)
        qDebug()<<a3[i]<<'\t';
    qDebug()<<endl;
    }

    double max_value=0;
    int max_index=-1;
    max(max_value,max_index,a3,output_layer_size);
    //if (max_value>=0.5)
        gestureindex=max_index;
    if (debug)
    {
        qDebug()<<a3[0]<<'\t'<<a3[1]<<'\t'<<a3[2]<<'\t'<<a3[3]<<'\t'<<a3[4]<<'\t'<<endl;
    }

}

void ANN::featureExtract()
{
    for (int i=0;i<input_layer_size;i++)
        feature[i]=0.0;
    if (debug)
    {
    for (int i=0;i<3;i++)
    {
        for (int j=0;j<inputdata[0].size();j++)
            qDebug()<<inputdata[i][j]<<'\t';
        qDebug()<<endl;
    }
}

    for (int i=0;i<channelNum;i++)
    {
        int size=inputdata[i].size();
        double *absdata=new double[size];
        abs(absdata,inputdata[i],size);
        feature[featureNum*i+0]=mean(absdata,size);
        delete []absdata;

        double *squaredata=new double[size];
        square(squaredata,inputdata[i],size);
        feature[featureNum*i+1]=sqrt(mean(squaredata,size));

        feature[featureNum*i+2]=mean(squaredata,size)*size/(size-1);

        delete []squaredata;

        double mean_value=mean(inputdata[i],size);
        double *deviation=new double[size];
        for (int j=0;j<size;j++)
            deviation[j]=(inputdata[i][j]-mean_value)*(inputdata[i][j]-mean_value);
        feature[featureNum*i+3]=sqrt(mean(deviation,size)*size/(size-1));
        delete []deviation;

        double *waveformlength=new double[size-1];
        for (int j=0;j<size-1;j++)
            waveformlength[j]=abs(inputdata[i][j+1]-inputdata[i][j]);
        feature[featureNum*i+4]=mean(waveformlength,size-1)*(size-1);
        delete []waveformlength;
/*
            double zerocrossing[size-1];
            for (int j=0;j<size-1;j++)
                zerocrossing[j]=(1.0-sign(inputdata[i][j]*inputdata[i][j+1]))/2;
            feature[featureNum*i+5]=mean(zerocrossing,size-1)*(size-1);

            double slopesignchange[size-2];
            for (int j=0;j<size-2;j++)
                slopesignchange[j]=(1.0-sign((inputdata[i][j+2]-inputdata[i][j+1])*(inputdata[i][j+1]-inputdata[i][j])))/2;
            feature[featureNum*i+6]=mean(slopesignchange,size-2)*(size-2);
        */

        feature[featureNum*i+5]=AR(inputdata[i],1,size);
        feature[featureNum*i+6]=AR(inputdata[i],2,size);
        feature[featureNum*i+7]=AR(inputdata[i],3,size);
        feature[featureNum*i+8]=AR(inputdata[i],4,size);
        feature[featureNum*i+9]=AR(inputdata[i],5,size);

        /*
        int segmentpoint[segmentNum+1];
        segmentpoint[0]=0;
        double len=size/segmentNum;
        for (int j=0;j<segmentNum;j++)
            segmentpoint[j+1]=((int)floor(len))*(j+1);
        for(int j=0;j<segmentNum;j++)
            feature[featureNum*i+10+j]=powerspectrum(inputdata[i],segmentpoint[j],segmentpoint[j+1]);
            */

    }
}

QString ANN::getcurrentgesture()
{
    if (gestureindex!=NONE)
        return gesturenames[gestureindex];
    else
        return "";
}

int ANN::getcurrentgestureindex()
{
    return gestureindex;
}

void ANN::reset()
{
    gestureindex=NONE;
    for (int i=0;i<channelNum;i++)
        inputdata[i].clear();
    activeindex.clear();
}

double ANN::mean(double *channelVol, int size)
{
    double sum=0;
    for (int i=0;i<size;i++)
        sum+=channelVol[i];
    sum/=size;
    return sum;
}

double ANN::mean(QVector<double> &data, int size)
{
    double sum=0;
    for (int i=0;i<size;i++)
        sum+=data[i];
    sum/=size;
    return sum;
}

void ANN::abs(double *absdata, QVector<double> &data, int size)
{
    for(int i=0; i<size; i++)
        absdata[i]=data[i]>0?data[i]:-data[i];
}
double ANN::abs(double data)
{
    return data>0?data:-data;
}

void ANN::square(double *squaredata,QVector<double> &data, int size)
{
    for (int i=0;i<size;i++)
        squaredata[i]=data[i]*data[i];
}

double ANN::sign(double data)
{
    if (data>0)
        return 1.0;
    else if (data<0)
        return -1.0;
    else
        return 0.0;
}


void ANN::multmat(double *theta, double *x, double *y, int m, int n)  //theta m行n列; x n行1列; y m行1列
{
    for(int i = 0; i < m; i++)
    {
        double s=0.0;
        for(int j = 0; j < n; j++)
            s+=(theta[n*i+j]*x[j]);
        y[i]=s;
    }
    return;
}

void ANN::sigmoid(double *data, int size)
{
    for (int i=0;i<size;i++)
        data[i]=1.0/(1.0+exp(-data[i]));
}

void ANN::bias(double* bias_data, double *data, int size)
{
    bias_data[0]=1.0;
    for (int i=0;i<size;i++)
        bias_data[i+1]=data[i];
}

void ANN::max(double &max_value, int &max_index, double *data, int size)  //输出第一个 是max_value 第二个是max_index
{
    max_value=data[0];
    max_index=0;
    for (int i=1;i<size;i++)
    {
        if (data[i]>max_value)
        {
            max_value=data[i];
            max_index=i;
        }
    }
}

double ANN::AR(QVector<double> &data, int m, int size)
{
    double ar=0.0;
    for(int i=0;i<size-m;i++)
        ar+=data[i]*data[i+m];
    return ar;
}

double ANN::powerspectrum(QVector<double> &data, int startpoint, int endpoint)  //平均频率
{
    double delta=2.0;
    double frequencySupremum=100.0;

    double Rep,Imp,fp=0.0,p=0.0;
    for (int j=0;j<(int)(frequencySupremum/delta);j++)
    {
        Rep=0.0;
        Imp=0.0;
        for(int i=startpoint;i<endpoint;i++)
        {
            Rep+=data[i]*cos((i-startpoint)*(j+1)*delta);
            Imp+=-data[i]*sin((i-startpoint)*(j+1)*delta);
        }
        p+=(Rep*Rep+Imp*Imp)/(endpoint-startpoint)*delta;
        fp+=(Rep*Rep+Imp*Imp)/(endpoint-startpoint)*(j+1)*delta*delta;
    }
    return fp/p;
}

void ANN::sort(double *value, int size)
{
    int i, j;
    double temp;
    for (i = 0; i < size - 1; i++)
    {
        for (j = 0; j < size - 1 - i; j++)
        {
            if (value[j] > value[j + 1])
            {
                temp = value[j];
                value[j] = value[j + 1];
                value[j + 1] = temp;
            }
        }
    }
}
